(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7719],{66136:function(e,t){/*!
 * FilePond 4.30.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */!function(e){"use strict";var t,r,n,createStore=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=Object.assign({},e),i=[],o=[],dispatch=function(e,t,r){if(r&&!document.hidden){o.push({type:e,data:t});return}s[e]&&s[e](t),i.push({type:e,data:t})},query=function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return a[e]?(t=a)[e].apply(t,n):null},a={};t.forEach(function(e){a=Object.assign({},e(n),{},a)});var s={};return r.forEach(function(e){s=Object.assign({},e(dispatch,query,n),{},s)}),{getState:function(){return Object.assign({},n)},processActionQueue:function(){var e=[].concat(i);return i.length=0,e},processDispatchQueue:function(){var e=[].concat(o);o.length=0,e.forEach(function(e){dispatch(e.type,e.data)})},dispatch:dispatch,query:query}},defineProperty=function(e,t,r){if("function"==typeof r){e[t]=r;return}Object.defineProperty(e,t,Object.assign({},r))},forin=function(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])},createObject=function(e){var t={};return forin(e,function(r){defineProperty(t,r,e[r])}),t},attr=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===r)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,r)},i=["svg","path"],isSVGElement=function(e){return i.includes(e)},createElement=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"==typeof t&&(r=t,t=null);var n=isSVGElement(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return t&&(isSVGElement(e)?attr(n,"class",t):n.className=t),forin(r,function(e,t){attr(n,e,t)}),n},o="undefined"!=typeof window&&void 0!==window.document,isBrowser=function(){return o},a="children"in(isBrowser()?createElement("svg"):{})?function(e){return e.children.length}:function(e){return e.childNodes.length},getViewRect=function(e,t,r,n){var i=r[0]||e.left,o=r[1]||e.top,a=i+e.width,s=o+e.height*(n[1]||1),l={element:Object.assign({},e),inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:i,top:o,right:a,bottom:s}};return t.filter(function(e){return!e.isRectIgnored()}).map(function(e){return e.rect}).forEach(function(e){expandRect(l.inner,Object.assign({},e.inner)),expandRect(l.outer,Object.assign({},e.outer))}),calculateRectSize(l.inner),l.outer.bottom+=l.element.marginBottom,l.outer.right+=l.element.marginRight,calculateRectSize(l.outer),l},expandRect=function(e,t){t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},calculateRectSize=function(e){e.width=e.right-e.left,e.height=e.bottom-e.top},isNumber=function(e){return"number"==typeof e},thereYet=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return Math.abs(e-t)<n&&Math.abs(r)<n},easeInOutQuad=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},s={spring:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stiffness,r=void 0===t?.5:t,n=e.damping,i=void 0===n?.75:n,o=e.mass,a=void 0===o?10:o,s=null,l=null,u=0,c=!1,f=createObject({interpolate:function(e,t){if(!c){if(!(isNumber(s)&&isNumber(l))){c=!0,u=0;return}u+=-(l-s)*r/a,l+=u,u*=i,thereYet(l,s,u)||t?(l=s,u=0,c=!0,f.onupdate(l),f.oncomplete(l)):f.onupdate(l)}},target:{set:function(e){if(isNumber(e)&&!isNumber(l)&&(l=e),null===s&&(s=e,l=e),l===(s=e)||void 0===s){c=!0,u=0,f.onupdate(l),f.oncomplete(l);return}c=!1},get:function(){return s}},resting:{get:function(){return c}},onupdate:function(e){},oncomplete:function(e){}});return f},tween:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.duration,i=void 0===n?500:n,o=r.easing,a=void 0===o?easeInOutQuad:o,s=r.delay,l=void 0===s?0:s,u=null,c=!0,f=!1,d=null,p=createObject({interpolate:function(r,n){!c&&null!==d&&(null===u&&(u=r),r-u<l||((e=r-u-l)>=i||n?(e=1,t=f?0:1,p.onupdate(t*d),p.oncomplete(t*d),c=!0):(t=e/i,p.onupdate((e>=0?a(f?1-t:t):0)*d))))},target:{get:function(){return f?0:d},set:function(e){if(null===d){d=e,p.onupdate(e),p.oncomplete(e);return}e<d?(d=1,f=!0):(f=!1,d=e),c=!1,u=null}},resting:{get:function(){return c}},onupdate:function(e){},oncomplete:function(e){}});return p}},createAnimator=function(e,t,r){var n=e[t]&&"object"==typeof e[t][r]?e[t][r]:e[t]||e,i="string"==typeof n?n:n.type,o="object"==typeof n?Object.assign({},n):{};return s[i]?s[i](o):null},addGetSet=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(t=Array.isArray(t)?t:[t]).forEach(function(t){e.forEach(function(e){var i=e,getter=function(){return r[e]},setter=function(t){return r[e]=t};"object"==typeof e&&(i=e.key,getter=e.getter||getter,setter=e.setter||setter),(!t[i]||n)&&(t[i]={get:getter,set:setter})})})},isDefined=function(e){return null!=e},l={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},propsHaveChanged=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!0;for(var r in t)if(t[r]!==e[r])return!0;return!1},applyStyles=function(e,t){var r=t.opacity,n=t.perspective,i=t.translateX,o=t.translateY,a=t.scaleX,s=t.scaleY,l=t.rotateX,u=t.rotateY,c=t.rotateZ,f=t.originX,d=t.originY,p=t.width,E=t.height,m="",I="";(isDefined(f)||isDefined(d))&&(I+="transform-origin: "+(f||0)+"px "+(d||0)+"px;"),isDefined(n)&&(m+="perspective("+n+"px) "),(isDefined(i)||isDefined(o))&&(m+="translate3d("+(i||0)+"px, "+(o||0)+"px, 0) "),(isDefined(a)||isDefined(s))&&(m+="scale3d("+(isDefined(a)?a:1)+", "+(isDefined(s)?s:1)+", 1) "),isDefined(c)&&(m+="rotateZ("+c+"rad) "),isDefined(l)&&(m+="rotateX("+l+"rad) "),isDefined(u)&&(m+="rotateY("+u+"rad) "),m.length&&(I+="transform:"+m+";"),isDefined(r)&&(I+="opacity:"+r+";",0===r&&(I+="visibility:hidden;"),r<1&&(I+="pointer-events:none;")),isDefined(E)&&(I+="height:"+E+"px;"),isDefined(p)&&(I+="width:"+p+"px;");var g=e.elementCurrentStyle||"";(I.length!==g.length||I!==g)&&(e.style.cssText=I,e.elementCurrentStyle=I)},u={styles:function(e){var t=e.mixinConfig,r=e.viewProps,n=e.viewInternalAPI,i=e.viewExternalAPI,o=e.view,a=Object.assign({},r),s={};addGetSet(t,[n,i],r);var getRect=function(){return o.rect?getViewRect(o.rect,o.childViews,[r.translateX||0,r.translateY||0],[r.scaleX||0,r.scaleY||0]):null};return n.rect={get:getRect},i.rect={get:getRect},t.forEach(function(e){r[e]=void 0===a[e]?l[e]:a[e]}),{write:function(){if(propsHaveChanged(s,r))return applyStyles(o.element,r),Object.assign(s,Object.assign({},r)),!0},destroy:function(){}}},listeners:function(e){e.mixinConfig,e.viewProps,e.viewInternalAPI;var t,r,n=e.viewExternalAPI,i=(e.viewState,e.view),o=[],a=(t=i.element,function(e,r){t.addEventListener(e,r)}),s=(r=i.element,function(e,t){r.removeEventListener(e,t)});return n.on=function(e,t){o.push({type:e,fn:t}),a(e,t)},n.off=function(e,t){o.splice(o.findIndex(function(r){return r.type===e&&r.fn===t}),1),s(e,t)},{write:function(){return!0},destroy:function(){o.forEach(function(e){s(e.type,e.fn)})}}},animations:function(e){var t=e.mixinConfig,r=e.viewProps,n=e.viewInternalAPI,i=e.viewExternalAPI,o=Object.assign({},r),a=[];return forin(t,function(e,t){var s=createAnimator(t);s&&(s.onupdate=function(t){r[e]=t},s.target=o[e],addGetSet([{key:e,setter:function(e){s.target!==e&&(s.target=e)},getter:function(){return r[e]}}],[n,i],r,!0),a.push(s))}),{write:function(e){var t=document.hidden,r=!0;return a.forEach(function(n){n.resting||(r=!1),n.interpolate(e,t)}),r},destroy:function(){}}},apis:function(e){var t=e.mixinConfig,r=e.viewProps;addGetSet(t,e.viewExternalAPI,r)}},updateRect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.layoutCalculated||(e.paddingTop=parseInt(r.paddingTop,10)||0,e.marginTop=parseInt(r.marginTop,10)||0,e.marginRight=parseInt(r.marginRight,10)||0,e.marginBottom=parseInt(r.marginBottom,10)||0,e.marginLeft=parseInt(r.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=null===t.offsetParent,e},createView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tag,r=void 0===t?"div":t,n=e.name,i=void 0===n?null:n,o=e.attributes,s=void 0===o?{}:o,l=e.read,c=void 0===l?function(){}:l,f=e.write,d=void 0===f?function(){}:f,p=e.create,E=void 0===p?function(){}:p,m=e.destroy,I=void 0===m?function(){}:m,g=e.filterFrameActionsForChild,_=void 0===g?function(e,t){return t}:g,T=e.didCreateView,v=void 0===T?function(){}:T,h=e.didWriteView,R=void 0===h?function(){}:h,O=e.ignoreRect,y=void 0!==O&&O,D=e.ignoreRectUpdate,S=void 0!==D&&D,A=e.mixins,b=void 0===A?[]:A;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=createElement(r,"filepond--"+i,s),o=window.getComputedStyle(n,null),l=updateRect(),f=null,p=!1,m=[],g=[],T={},h={},O=[d],D=[c],A=[I],getElement=function(){return n},getChildViews=function(){return m.concat()},getRect=function(){return f||(f=getViewRect(l,m,[0,0],[1,1]))},P={element:{get:getElement},style:{get:function(){return o}},childViews:{get:getChildViews}},L=Object.assign({},P,{rect:{get:getRect},ref:{get:function(){return T}},is:function(e){return i===e},appendChild:function(e,t){void 0!==t&&n.children[t]?n.insertBefore(e,n.children[t]):n.appendChild(e)},createChildView:function(t,r){return t(e,r)},linkView:function(e){return m.push(e),e},unlinkView:function(e){m.splice(m.indexOf(e),1)},appendChildView:function(e,t){return void 0!==t?m.splice(t,0,e):m.push(e),e},removeChildView:function(e){return m.splice(m.indexOf(e),1),e.element.parentNode&&n.removeChild(e.element),e},registerWriter:function(e){return O.push(e)},registerReader:function(e){return D.push(e)},registerDestroyer:function(e){return A.push(e)},invalidateLayout:function(){return n.layoutCalculated=!1},dispatch:e.dispatch,query:e.query}),C={element:{get:getElement},childViews:{get:getChildViews},rect:{get:getRect},resting:{get:function(){return p}},isRectIgnored:function(){return y},_read:function(){f=null,m.forEach(function(e){return e._read()}),S&&l.width&&l.height||updateRect(l,n,o);var e={root:N,props:t,rect:l};D.forEach(function(t){return t(e)})},_write:function(e,r,n){var i=0===r.length;return O.forEach(function(o){!1===o({props:t,root:N,actions:r,timestamp:e,shouldOptimize:n})&&(i=!1)}),g.forEach(function(t){!1===t.write(e)&&(i=!1)}),m.filter(function(e){return!!e.element.parentNode}).forEach(function(t){t._write(e,_(t,r),n)||(i=!1)}),m.forEach(function(t,o){t.element.parentNode||(N.appendChild(t.element,o),t._read(),t._write(e,_(t,r),n),i=!1)}),p=i,R({props:t,root:N,actions:r,timestamp:e}),i},_destroy:function(){g.forEach(function(e){return e.destroy()}),A.forEach(function(e){e({root:N,props:t})}),m.forEach(function(e){return e._destroy()})}},M=Object.assign({},P,{rect:{get:function(){return l}}});Object.keys(b).sort(function(e,t){return"styles"===e?1:"styles"===t?-1:0}).forEach(function(e){var r=u[e]({mixinConfig:b[e],viewProps:t,viewState:h,viewInternalAPI:L,viewExternalAPI:C,view:createObject(M)});r&&g.push(r)});var N=createObject(L);E({root:N,props:t});var w=a(n);return m.forEach(function(e,t){N.appendChild(e.element,w+t)}),v(N),createObject(C)}},createRoute=function(e,t){return function(r){var n=r.root,i=r.props,o=r.actions,a=void 0===o?[]:o,s=r.timestamp,l=r.shouldOptimize;a.filter(function(t){return e[t.type]}).forEach(function(t){return e[t.type]({root:n,props:i,action:t.data,timestamp:s,shouldOptimize:l})}),t&&t({root:n,props:i,actions:a,timestamp:s,shouldOptimize:l})}},insertBefore=function(e,t){return t.parentNode.insertBefore(e,t)},insertAfter=function(e,t){return t.parentNode.insertBefore(e,t.nextSibling)},isArray=function(e){return Array.isArray(e)},isEmpty=function(e){return null==e},trim=function(e){return e.trim()},toString=function(e){return""+e},isBoolean=function(e){return"boolean"==typeof e},toBoolean=function(e){return isBoolean(e)?e:"true"===e},isString=function(e){return"string"==typeof e},toNumber=function(e){return isNumber(e)?e:isString(e)?toString(e).replace(/[a-z]+/gi,""):0},toInt=function(e){return parseInt(toNumber(e),10)},toFloat=function(e){return parseFloat(toNumber(e))},isInt=function(e){return isNumber(e)&&isFinite(e)&&Math.floor(e)===e},toBytes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(isInt(e))return e;var r=toString(e).trim();return/MB$/i.test(r)?toInt(r=r.replace(/MB$i/,"").trim())*t*t:/KB/i.test(r)?toInt(r=r.replace(/KB$i/,"").trim())*t:toInt(r)},isFunction=function(e){return"function"==typeof e},toFunctionReference=function(e){for(var t=self,r=e.split("."),n=null;n=r.shift();)if(!(t=t[n]))return null;return t},c={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},createServerAPI=function(e){var t={};return t.url=isString(e)?e:e.url||"",t.timeout=e.timeout?parseInt(e.timeout,10):0,t.headers=e.headers?e.headers:{},forin(c,function(r){t[r]=createAction(r,e[r],c[r],t.timeout,t.headers)}),t.process=e.process||isString(e)||e.url?t.process:null,t.remove=e.remove||null,delete t.headers,t},createAction=function(e,t,r,n,i){if(null===t)return null;if("function"==typeof t)return t;var o={url:"GET"===r||"PATCH"===r?"?"+e+"=":"",method:r,headers:i,withCredentials:!1,timeout:n,onload:null,ondata:null,onerror:null};if(isString(t))return o.url=t,o;if(Object.assign(o,t),isString(o.headers)){var a=o.headers.split(/:(.+)/);o.headers={header:a[0],value:a[1]}}return o.withCredentials=toBoolean(o.withCredentials),o},isObject=function(e){return"object"==typeof e&&null!==e},getType=function(e){return isArray(e)?"array":null===e?"null":isInt(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":isObject(e)&&isString(e.url)&&isObject(e.process)&&isObject(e.revert)&&isObject(e.restore)&&isObject(e.fetch)?"api":typeof e},f={array:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return isEmpty(e)?[]:isArray(e)?e:toString(e).split(t).map(trim).filter(function(e){return e.length})},boolean:toBoolean,int:function(e){return"bytes"===getType(e)?toBytes(e):toInt(e)},number:toFloat,float:toFloat,bytes:toBytes,string:function(e){return isFunction(e)?e:toString(e)},function:function(e){return toFunctionReference(e)},serverapi:function(e){return createServerAPI(e)},object:function(e){try{return JSON.parse(e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'))}catch(e){return null}}},getValueByType=function(e,t,r){if(e===t)return e;var n=getType(e);if(n!==r){var i,o=(i=e,f[r](i));if(n=getType(o),null===o)throw'Trying to assign value with incorrect type to "'+option+'", allowed type: "'+r+'"';e=o}return e},createOption=function(e,t){var r=e;return{enumerable:!0,get:function(){return r},set:function(n){r=getValueByType(n,e,t)}}},createOptions=function(e){var t={};return forin(e,function(r){var n=e[r];t[r]=createOption(n[0],n[1])}),createObject(t)},fromCamels=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.split(/(?=[A-Z])/).map(function(e){return e.toLowerCase()}).join(t)},createOptionAPI=function(e,t){var r={};return forin(t,function(t){r[t]={get:function(){return e.getState().options[t]},set:function(r){e.dispatch("SET_"+fromCamels(t,"_").toUpperCase(),{value:r})}}}),r},d={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},getUniqueId=function(){return Math.random().toString(36).substring(2,11)};function _AwaitValue(e){this.wrapped=e}function _AsyncGenerator(e){var t,r;function resume(t,r){try{var n=e[t](r),i=n.value,o=i instanceof _AwaitValue;Promise.resolve(o?i.wrapped:i).then(function(e){if(o){resume("next",e);return}settle(n.done?"return":"normal",e)},function(e){resume("throw",e)})}catch(e){settle("throw",e)}}function settle(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?resume(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise(function(i,o){var a={key:e,arg:n,resolve:i,reject:o,next:null};r?r=r.next=a:(t=r=a,resume(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function _toConsumableArray(e){return function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}()}"function"==typeof Symbol&&Symbol.asyncIterator&&(_AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this}),_AsyncGenerator.prototype.next=function(e){return this._invoke("next",e)},_AsyncGenerator.prototype.throw=function(e){return this._invoke("throw",e)},_AsyncGenerator.prototype.return=function(e){return this._invoke("return",e)};var arrayRemove=function(e,t){return e.splice(t,1)},run=function(e,t){t?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)},on=function(){var e=[],off=function(t,r){arrayRemove(e,e.findIndex(function(e){return e.event===t&&(e.cb===r||!r)}))},_fire=function(t,r,n){e.filter(function(e){return e.event===t}).map(function(e){return e.cb}).forEach(function(e){return run(function(){return e.apply(void 0,_toConsumableArray(r))},n)})};return{fireSync:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];_fire(e,r,!0)},fire:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];_fire(e,r,!1)},on:function(t,r){e.push({event:t,cb:r})},onOnce:function(t,r){e.push({event:t,cb:function(){off(t,r),r.apply(void 0,arguments)}})},off:off}},copyObjectPropertiesToObject=function(e,t,r){Object.getOwnPropertyNames(e).filter(function(e){return!r.includes(e)}).forEach(function(r){return Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})},p=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],createItemAPI=function(e){var t={};return copyObjectPropertiesToObject(e,t,p),t},removeReleasedItems=function(e){e.forEach(function(t,r){t.released&&arrayRemove(e,r)})},E={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},m={INPUT:1,LIMBO:2,LOCAL:3},getNonNumeric=function(e){return/[^0-9]+/.exec(e)},getDecimalSeparator=function(){return getNonNumeric(1.1.toLocaleString())[0]},I={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},g=[],applyFilterChain=function(e,t,r){return new Promise(function(n,i){var o=g.filter(function(t){return t.key===e}).map(function(e){return e.cb});if(0===o.length){n(t);return}var a=o.shift();o.reduce(function(e,t){return e.then(function(e){return t(e,r)})},a(t,r)).then(function(e){return n(e)}).catch(function(e){return i(e)})})},applyFilters=function(e,t,r){return g.filter(function(t){return t.key===e}).map(function(e){return e.cb(t,r)})},addFilter=function(e,t){return g.push({key:e,cb:t})},getOptions=function(){return Object.assign({},_)},setOptions=function(e){forin(e,function(e,t){_[e]&&(_[e][0]=getValueByType(t,_[e][0],_[e][1]))})},_={id:[null,I.STRING],name:["filepond",I.STRING],disabled:[!1,I.BOOLEAN],className:[null,I.STRING],required:[!1,I.BOOLEAN],captureMethod:[null,I.STRING],allowSyncAcceptAttribute:[!0,I.BOOLEAN],allowDrop:[!0,I.BOOLEAN],allowBrowse:[!0,I.BOOLEAN],allowPaste:[!0,I.BOOLEAN],allowMultiple:[!1,I.BOOLEAN],allowReplace:[!0,I.BOOLEAN],allowRevert:[!0,I.BOOLEAN],allowRemove:[!0,I.BOOLEAN],allowProcess:[!0,I.BOOLEAN],allowReorder:[!1,I.BOOLEAN],allowDirectoriesOnly:[!1,I.BOOLEAN],storeAsFile:[!1,I.BOOLEAN],forceRevert:[!1,I.BOOLEAN],maxFiles:[null,I.INT],checkValidity:[!1,I.BOOLEAN],itemInsertLocationFreedom:[!0,I.BOOLEAN],itemInsertLocation:["before",I.STRING],itemInsertInterval:[75,I.INT],dropOnPage:[!1,I.BOOLEAN],dropOnElement:[!0,I.BOOLEAN],dropValidation:[!1,I.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],I.ARRAY],instantUpload:[!0,I.BOOLEAN],maxParallelUploads:[2,I.INT],allowMinimumUploadDuration:[!0,I.BOOLEAN],chunkUploads:[!1,I.BOOLEAN],chunkForce:[!1,I.BOOLEAN],chunkSize:[5e6,I.INT],chunkRetryDelays:[[500,1e3,3e3],I.ARRAY],server:[null,I.SERVER_API],fileSizeBase:[1e3,I.INT],labelFileSizeBytes:["bytes",I.STRING],labelFileSizeKilobytes:["KB",I.STRING],labelFileSizeMegabytes:["MB",I.STRING],labelFileSizeGigabytes:["GB",I.STRING],labelDecimalSeparator:[getDecimalSeparator(),I.STRING],labelThousandsSeparator:[(t=getDecimalSeparator(),"1000"!==(r=1e3.toLocaleString())?getNonNumeric(r)[0]:"."===t?",":"."),I.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',I.STRING],labelInvalidField:["Field contains invalid files",I.STRING],labelFileWaitingForSize:["Waiting for size",I.STRING],labelFileSizeNotAvailable:["Size not available",I.STRING],labelFileCountSingular:["file in list",I.STRING],labelFileCountPlural:["files in list",I.STRING],labelFileLoading:["Loading",I.STRING],labelFileAdded:["Added",I.STRING],labelFileLoadError:["Error during load",I.STRING],labelFileRemoved:["Removed",I.STRING],labelFileRemoveError:["Error during remove",I.STRING],labelFileProcessing:["Uploading",I.STRING],labelFileProcessingComplete:["Upload complete",I.STRING],labelFileProcessingAborted:["Upload cancelled",I.STRING],labelFileProcessingError:["Error during upload",I.STRING],labelFileProcessingRevertError:["Error during revert",I.STRING],labelTapToCancel:["tap to cancel",I.STRING],labelTapToRetry:["tap to retry",I.STRING],labelTapToUndo:["tap to undo",I.STRING],labelButtonRemoveItem:["Remove",I.STRING],labelButtonAbortItemLoad:["Abort",I.STRING],labelButtonRetryItemLoad:["Retry",I.STRING],labelButtonAbortItemProcessing:["Cancel",I.STRING],labelButtonUndoItemProcessing:["Undo",I.STRING],labelButtonRetryItemProcessing:["Retry",I.STRING],labelButtonProcessItem:["Upload",I.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',I.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',I.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',I.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',I.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',I.STRING],oninit:[null,I.FUNCTION],onwarning:[null,I.FUNCTION],onerror:[null,I.FUNCTION],onactivatefile:[null,I.FUNCTION],oninitfile:[null,I.FUNCTION],onaddfilestart:[null,I.FUNCTION],onaddfileprogress:[null,I.FUNCTION],onaddfile:[null,I.FUNCTION],onprocessfilestart:[null,I.FUNCTION],onprocessfileprogress:[null,I.FUNCTION],onprocessfileabort:[null,I.FUNCTION],onprocessfilerevert:[null,I.FUNCTION],onprocessfile:[null,I.FUNCTION],onprocessfiles:[null,I.FUNCTION],onremovefile:[null,I.FUNCTION],onpreparefile:[null,I.FUNCTION],onupdatefiles:[null,I.FUNCTION],onreorderfiles:[null,I.FUNCTION],beforeDropFile:[null,I.FUNCTION],beforeAddFile:[null,I.FUNCTION],beforeRemoveFile:[null,I.FUNCTION],beforePrepareFile:[null,I.FUNCTION],stylePanelLayout:[null,I.STRING],stylePanelAspectRatio:[null,I.STRING],styleItemPanelAspectRatio:[null,I.STRING],styleButtonRemoveItemPosition:["left",I.STRING],styleButtonProcessItemPosition:["right",I.STRING],styleLoadIndicatorPosition:["right",I.STRING],styleProgressIndicatorPosition:["right",I.STRING],styleButtonRemoveItemAlign:[!1,I.BOOLEAN],files:[[],I.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],I.ARRAY]},getItemByQuery=function(e,t){return isEmpty(t)?e[0]||null:isInt(t)?e[t]||null:("object"==typeof t&&(t=t.id),e.find(function(e){return e.id===t})||null)},getNumericAspectRatioFromString=function(e){if(isEmpty(e))return e;if(/:/.test(e)){var t=e.split(":");return t[1]/t[0]}return parseFloat(e)},getActiveItems=function(e){return e.filter(function(e){return!e.archived})},T={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4},v=null,canUpdateFileInput=function(){if(null===v)try{var e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));var t=document.createElement("input");t.setAttribute("type","file"),t.files=e.files,v=1===t.files.length}catch(e){v=!1}return v},h=[E.LOAD_ERROR,E.PROCESSING_ERROR,E.PROCESSING_REVERT_ERROR],R=[E.LOADING,E.PROCESSING,E.PROCESSING_QUEUED,E.INIT],O=[E.PROCESSING_COMPLETE],isItemInErrorState=function(e){return h.includes(e.status)},isItemInBusyState=function(e){return R.includes(e.status)},isItemInReadyState=function(e){return O.includes(e.status)},isAsync=function(e){return isObject(e.options.server)&&(isObject(e.options.server.process)||isFunction(e.options.server.process))},queries=function(e){return{GET_STATUS:function(){var t=getActiveItems(e.items),r=T.EMPTY,n=T.ERROR,i=T.BUSY,o=T.IDLE,a=T.READY;return 0===t.length?r:t.some(isItemInErrorState)?n:t.some(isItemInBusyState)?i:t.some(isItemInReadyState)?a:o},GET_ITEM:function(t){return getItemByQuery(e.items,t)},GET_ACTIVE_ITEM:function(t){return getItemByQuery(getActiveItems(e.items),t)},GET_ACTIVE_ITEMS:function(){return getActiveItems(e.items)},GET_ITEMS:function(){return e.items},GET_ITEM_NAME:function(t){var r=getItemByQuery(e.items,t);return r?r.filename:null},GET_ITEM_SIZE:function(t){var r=getItemByQuery(e.items,t);return r?r.fileSize:null},GET_STYLES:function(){return Object.keys(e.options).filter(function(e){return/^style/.test(e)}).map(function(t){return{name:t,value:e.options[t]}})},GET_PANEL_ASPECT_RATIO:function(){return/circle/.test(e.options.stylePanelLayout)?1:getNumericAspectRatioFromString(e.options.stylePanelAspectRatio)},GET_ITEM_PANEL_ASPECT_RATIO:function(){return e.options.styleItemPanelAspectRatio},GET_ITEMS_BY_STATUS:function(t){return getActiveItems(e.items).filter(function(e){return e.status===t})},GET_TOTAL_ITEMS:function(){return getActiveItems(e.items).length},SHOULD_UPDATE_FILE_INPUT:function(){return e.options.storeAsFile&&canUpdateFileInput()&&!isAsync(e)},IS_ASYNC:function(){return isAsync(e)},GET_FILE_SIZE_LABELS:function(e){return{labelBytes:e("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:e("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:e("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:e("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0}}}},hasRoomForItem=function(e){var t=getActiveItems(e.items).length;if(!e.options.allowMultiple)return 0===t;var r=e.options.maxFiles;return null===r||t<r},limit=function(e,t,r){return Math.max(Math.min(r,e),t)},insertItem=function(e,t,r){var n;return isEmpty(t)?null:(void 0===r?e.push(t):(n=r=limit(r,0,e.length),e.splice(n,0,t)),t)},isBase64DataURI=function(e){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e)},getFilenameFromURL=function(e){return e.split("/").pop().split("?").shift()},getExtensionFromFilename=function(e){return e.split(".").pop()},guesstimateExtension=function(e){if("string"!=typeof e)return"";var t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?"jpeg"===t?"jpg":t:""},leftPad=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(t+e).slice(-t.length)},getDateString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return e.getFullYear()+"-"+leftPad(e.getMonth()+1,"00")+"-"+leftPad(e.getDate(),"00")+"_"+leftPad(e.getHours(),"00")+"-"+leftPad(e.getMinutes(),"00")+"-"+leftPad(e.getSeconds(),"00")},getFileFromBlob=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i="string"==typeof r?e.slice(0,e.size,r):e.slice(0,e.size,e.type);return i.lastModifiedDate=new Date,e._relativePath&&(i._relativePath=e._relativePath),isString(t)||(t=getDateString()),t&&null===n&&getExtensionFromFilename(t)?i.name=t:(n=n||guesstimateExtension(i.type),i.name=t+(n?"."+n:"")),i},createBlob=function(e,t){var r=window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(r){var n=new r;return n.append(e),n.getBlob(t)}return new Blob([e],{type:t})},getBlobFromByteStringWithMimeType=function(e,t){for(var r=new ArrayBuffer(e.length),n=new Uint8Array(r),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return createBlob(r,t)},getMimeTypeFromBase64DataURI=function(e){return(/^data:(.+);/.exec(e)||[])[1]||null},getBlobFromBase64DataURI=function(e){var t=getMimeTypeFromBase64DataURI(e);return getBlobFromByteStringWithMimeType(atob(e.split(",")[1].replace(/\s/g,"")),t)},getFileNameFromHeader=function(e){if(!/^content-disposition:/i.test(e))return null;var t=e.split(/filename=|filename\*=.+''/).splice(1).map(function(e){return e.trim().replace(/^["']|[;"']{0,2}$/g,"")}).filter(function(e){return e.length});return t.length?decodeURI(t[t.length-1]):null},getFileSizeFromHeader=function(e){if(/content-length:/i.test(e)){var t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},getFileInfoFromHeaders=function(e){var t={source:null,name:null,size:null},r=e.split("\n"),n=!0,i=!1,o=void 0;try{for(var a,s=r[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value,u=getFileNameFromHeader(l);if(u){t.name=u;continue}var c=getFileSizeFromHeader(l);if(c){t.size=c;continue}var f=/x-content-transfer-id:/i.test(l)&&(l.split(":")[1]||"").trim()||null;if(f){t.source=f;continue}}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return t},createFileLoader=function(e){var t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},loadURL=function(n){if(!e){r.fire("error",{type:"error",body:"Can't load URL",code:400});return}t.timestamp=Date.now(),t.request=e(n,function(e){t.duration=Date.now()-t.timestamp,t.complete=!0,e instanceof Blob&&(e=getFileFromBlob(e,e.name||getFilenameFromURL(n))),r.fire("load",e instanceof Blob?e:e?e.body:null)},function(e){r.fire("error","string"==typeof e?{type:"error",code:0,body:e}:e)},function(e,n,i){if(i&&(t.size=i),t.duration=Date.now()-t.timestamp,!e){t.progress=null;return}t.progress=n/i,r.fire("progress",t.progress)},function(){r.fire("abort")},function(e){var n=getFileInfoFromHeaders("string"==typeof e?e:e.headers);r.fire("meta",{size:t.size||n.size,filename:n.name,source:n.source})})},r=Object.assign({},on(),{setSource:function(e){return t.source=e},getProgress:function(){return t.progress},abort:function(){t.request&&t.request.abort&&t.request.abort()},load:function(){var e=t.source;(r.fire("init",e),e instanceof File)?r.fire("load",e):e instanceof Blob?r.fire("load",getFileFromBlob(e,e.name)):isBase64DataURI(e)?r.fire("load",getFileFromBlob(getBlobFromBase64DataURI(e),void 0,null,void 0)):loadURL(e)}});return r},isGet=function(e){return/GET|HEAD/.test(e)},sendRequest=function(e,t,r){var n={onheaders:function(){},onprogress:function(){},onload:function(){},ontimeout:function(){},onerror:function(){},onabort:function(){},abort:function(){i=!0,a.abort()}},i=!1,o=!1;r=Object.assign({method:"POST",headers:{},withCredentials:!1},r),t=encodeURI(t),isGet(r.method)&&e&&(t=""+t+encodeURIComponent("string"==typeof e?e:JSON.stringify(e)));var a=new XMLHttpRequest;return(isGet(r.method)?a:a.upload).onprogress=function(e){i||n.onprogress(e.lengthComputable,e.loaded,e.total)},a.onreadystatechange=function(){a.readyState<2||4===a.readyState&&0===a.status||o||(o=!0,n.onheaders(a))},a.onload=function(){a.status>=200&&a.status<300?n.onload(a):n.onerror(a)},a.onerror=function(){return n.onerror(a)},a.onabort=function(){i=!0,n.onabort()},a.ontimeout=function(){return n.ontimeout(a)},a.open(r.method,t,!0),isInt(r.timeout)&&(a.timeout=r.timeout),Object.keys(r.headers).forEach(function(e){var t=unescape(encodeURIComponent(r.headers[e]));a.setRequestHeader(e,t)}),r.responseType&&(a.responseType=r.responseType),r.withCredentials&&(a.withCredentials=!0),a.send(e),n},createResponse=function(e,t,r,n){return{type:e,code:t,body:r,headers:n}},createTimeoutResponse=function(e){return function(t){e(createResponse("error",0,"Timeout",t.getAllResponseHeaders()))}},hasQS=function(e){return/\?/.test(e)},buildURL=function(){for(var e="",t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach(function(t){e+=hasQS(e)&&hasQS(t)?t.replace(/\?/,"&"):t}),e},createFetchFunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if("function"==typeof t)return t;if(!t||!isString(t.url))return null;var r=t.onload||function(e){return e},n=t.onerror||function(e){return null};return function(i,o,a,s,l,u){var c=sendRequest(i,buildURL(e,t.url),Object.assign({},t,{responseType:"blob"}));return c.onload=function(e){var n=e.getAllResponseHeaders(),a=getFileInfoFromHeaders(n).name||getFilenameFromURL(i);o(createResponse("load",e.status,"HEAD"===t.method?null:getFileFromBlob(r(e.response),a),n))},c.onerror=function(e){a(createResponse("error",e.status,n(e.response)||e.statusText,e.getAllResponseHeaders()))},c.onheaders=function(e){u(createResponse("headers",e.status,null,e.getAllResponseHeaders()))},c.ontimeout=createTimeoutResponse(a),c.onprogress=s,c.onabort=l,c}},y={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4},processFileChunked=function(e,t,r,n,i,o,a,s,l,u,c){for(var f,d,p,E,m,I,g,_,T=[],v=c.chunkTransferId,h=c.chunkServer,R=c.chunkSize,O=c.chunkRetryDelays,D={serverId:v,aborted:!1},S=t.ondata||function(e){return e},A=t.onload||function(e,t){return"HEAD"===t?e.getResponseHeader("Upload-Offset"):e.response},b=t.onerror||function(e){return null},P=Math.floor(n.size/R),L=0;L<=P;L++){var C=L*R,M=n.slice(C,C+R,"application/offset+octet-stream");T[L]={index:L,size:M.size,offset:C,data:M,file:n,progress:0,retries:_toConsumableArray(O),status:y.QUEUED,error:null,request:null,timeout:null}}var canProcessChunk=function(e){return e.status===y.QUEUED||e.status===y.ERROR},processChunk=function(t){if(!D.aborted){if(!(t=t||T.find(canProcessChunk))){T.every(function(e){return e.status===y.COMPLETE})&&o(D.serverId);return}t.status=y.PROCESSING,t.progress=null;var r=h.ondata||function(e){return e},i=h.onerror||function(e){return null},s=buildURL(e,h.url,D.serverId),u="function"==typeof h.headers?h.headers(t):Object.assign({},h.headers,{"Content-Type":"application/offset+octet-stream","Upload-Offset":t.offset,"Upload-Length":n.size,"Upload-Name":n.name}),c=t.request=sendRequest(r(t.data),s,Object.assign({},h,{headers:u}));c.onload=function(){t.status=y.COMPLETE,t.request=null,processChunks()},c.onprogress=function(e,r,n){t.progress=e?r:null,updateTotalProgress()},c.onerror=function(e){t.status=y.ERROR,t.request=null,t.error=i(e.response)||e.statusText,retryProcessChunk(t)||a(createResponse("error",e.status,i(e.response)||e.statusText,e.getAllResponseHeaders()))},c.ontimeout=function(e){t.status=y.ERROR,t.request=null,retryProcessChunk(t)||createTimeoutResponse(a)(e)},c.onabort=function(){t.status=y.QUEUED,t.request=null,l()}}},retryProcessChunk=function(e){return 0!==e.retries.length&&(e.status=y.WAITING,clearTimeout(e.timeout),e.timeout=setTimeout(function(){processChunk(e)},e.retries.shift()),!0)},updateTotalProgress=function(){var e=T.reduce(function(e,t){return null===e||null===t.progress?null:e+t.progress},0);if(null===e)return s(!1,0,0);s(!0,e,T.reduce(function(e,t){return e+t.size},0))},processChunks=function(){T.filter(function(e){return e.status===y.PROCESSING}).length>=1||processChunk()},abortChunks=function(){T.forEach(function(e){clearTimeout(e.timeout),e.request&&e.request.abort()})};return D.serverId?(f=function(e){D.aborted||(T.filter(function(t){return t.offset<e}).forEach(function(e){e.status=y.COMPLETE,e.progress=e.size}),processChunks())},(p=sendRequest(null,buildURL(e,h.url,D.serverId),d={headers:"function"==typeof t.headers?t.headers(D.serverId):Object.assign({},t.headers),method:"HEAD"})).onload=function(e){return f(A(e,d.method))},p.onerror=function(e){return a(createResponse("error",e.status,b(e.response)||e.statusText,e.getAllResponseHeaders()))},p.ontimeout=createTimeoutResponse(a)):(E=function(e){D.aborted||(u(e),D.serverId=e,processChunks())},m=new FormData,isObject(i)&&m.append(r,JSON.stringify(i)),I="function"==typeof t.headers?t.headers(n,i):Object.assign({},t.headers,{"Upload-Length":n.size}),g=Object.assign({},t,{headers:I}),(_=sendRequest(S(m),buildURL(e,t.url),g)).onload=function(e){return E(A(e,g.method))},_.onerror=function(e){return a(createResponse("error",e.status,b(e.response)||e.statusText,e.getAllResponseHeaders()))},_.ontimeout=createTimeoutResponse(a)),{abort:function(){D.aborted=!0,abortChunks()}}},createProcessorFunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return"function"==typeof t?function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return t.apply(void 0,[r].concat(i,[n]))}:t&&isString(t.url)?function(i,o,a,s,l,u,c){if(i){var f=n.chunkUploads,d=f&&i.size>n.chunkSize,p=f&&(d||n.chunkForce);if(i instanceof Blob&&p)return processFileChunked(e,t,r,i,o,a,s,l,u,c,n);var E=t.ondata||function(e){return e},m=t.onload||function(e){return e},I=t.onerror||function(e){return null},g="function"==typeof t.headers?t.headers(i,o)||{}:Object.assign({},t.headers),_=Object.assign({},t,{headers:g}),T=new FormData;isObject(o)&&T.append(r,JSON.stringify(o)),(i instanceof Blob?[{name:null,file:i}]:i).forEach(function(e){T.append(r,e.file,null===e.name?e.file.name:""+e.name+e.file.name)});var v=sendRequest(E(T),buildURL(e,t.url),_);return v.onload=function(e){a(createResponse("load",e.status,m(e.response),e.getAllResponseHeaders()))},v.onerror=function(e){s(createResponse("error",e.status,I(e.response)||e.statusText,e.getAllResponseHeaders()))},v.ontimeout=createTimeoutResponse(s),v.onprogress=l,v.onabort=u,v}}:null},createRevertFunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if("function"==typeof t)return t;if(!t||!isString(t.url))return function(e,t){return t()};var r=t.onload||function(e){return e},n=t.onerror||function(e){return null};return function(i,o,a){var s=sendRequest(i,e+t.url,t);return s.onload=function(e){o(createResponse("load",e.status,r(e.response),e.getAllResponseHeaders()))},s.onerror=function(e){a(createResponse("error",e.status,n(e.response)||e.statusText,e.getAllResponseHeaders()))},s.ontimeout=createTimeoutResponse(a),s}},getRandomNumber=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e+Math.random()*(t-e)},createPerceivedPerformanceUpdater=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;arguments.length>2&&void 0!==arguments[2]&&arguments[2];var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:250,i=null,o=Date.now();return t>0&&function tick(){var a=Date.now()-o,s=getRandomNumber(r,n);a+s>t&&(s=a+s-t);var l=a/t;if(l>=1||document.hidden){e(1);return}e(l),i=setTimeout(tick,s)}(),{clear:function(){clearTimeout(i)}}},createFileProcessor=function(e,t){var r={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},n=t.allowMinimumUploadDuration,abort=function(){r.request&&(r.perceivedPerformanceUpdater.clear(),r.request.abort&&r.request.abort(),r.complete=!0)},i=n?function(){return r.progress?Math.min(r.progress,r.perceivedProgress):null}:function(){return r.progress||null},o=n?function(){return Math.min(r.duration,r.perceivedDuration)}:function(){return r.duration},a=Object.assign({},on(),{process:function(t,i){var progressFn=function(){0!==r.duration&&null!==r.progress&&a.fire("progress",a.getProgress())},completeFn=function(){r.complete=!0,a.fire("load-perceived",r.response.body)};a.fire("start"),r.timestamp=Date.now(),r.perceivedPerformanceUpdater=createPerceivedPerformanceUpdater(function(e){r.perceivedProgress=e,r.perceivedDuration=Date.now()-r.timestamp,progressFn(),r.response&&1===r.perceivedProgress&&!r.complete&&completeFn()},n?getRandomNumber(750,1500):0),r.request=e(t,i,function(e){r.response=isObject(e)?e:{type:"load",code:200,body:""+e,headers:{}},r.duration=Date.now()-r.timestamp,r.progress=1,a.fire("load",r.response.body),(!n||n&&1===r.perceivedProgress)&&completeFn()},function(e){r.perceivedPerformanceUpdater.clear(),a.fire("error",isObject(e)?e:{type:"error",code:0,body:""+e})},function(e,t,n){r.duration=Date.now()-r.timestamp,r.progress=e?t/n:null,progressFn()},function(){r.perceivedPerformanceUpdater.clear(),a.fire("abort",r.response?r.response.body:null)},function(e){a.fire("transfer",e)})},abort:abort,getProgress:i,getDuration:o,reset:function(){abort(),r.complete=!1,r.perceivedProgress=0,r.progress=0,r.timestamp=null,r.perceivedDuration=0,r.duration=0,r.request=null,r.response=null}});return a},getFilenameWithoutExtension=function(e){return e.substring(0,e.lastIndexOf("."))||e},createFileStub=function(e){var t=[e.name,e.size,e.type];return e instanceof Blob||isBase64DataURI(e)?t[0]=e.name||getDateString():isBase64DataURI(e)?(t[1]=e.length,t[2]=getMimeTypeFromBase64DataURI(e)):isString(e)&&(t[0]=getFilenameFromURL(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},isFile=function(e){return!!(e instanceof File||e instanceof Blob&&e.name)},deepCloneObject=function deepCloneObject(e){if(!isObject(e))return e;var t=isArray(e)?[]:{};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];t[r]=n&&isObject(n)?deepCloneObject(n):n}return t},createItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=getUniqueId(),i={archived:!1,frozen:!1,released:!1,source:null,file:r,serverFileReference:t,transferId:null,processingAborted:!1,status:t?E.PROCESSING_COMPLETE:E.INIT,activeLoader:null,activeProcessor:null},o=null,a={},setStatus=function(e){return i.status=e},fire=function(e){if(!i.released&&!i.frozen){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];s.fire.apply(s,[e].concat(r))}},_setMetadata=function(e,t,r){var n=e.split("."),i=n[0],o=n.pop(),s=a;n.forEach(function(e){return s=s[e]}),JSON.stringify(s[o])!==JSON.stringify(t)&&(s[o]=t,fire("metadata-update",{key:i,value:a[i],silent:r}))},s=Object.assign({id:{get:function(){return n}},origin:{get:function(){return e},set:function(t){return e=t}},serverId:{get:function(){return i.serverFileReference}},transferId:{get:function(){return i.transferId}},status:{get:function(){return i.status}},filename:{get:function(){return i.file.name}},filenameWithoutExtension:{get:function(){return getFilenameWithoutExtension(i.file.name)}},fileExtension:{get:function(){return getExtensionFromFilename(i.file.name)}},fileType:{get:function(){return i.file.type}},fileSize:{get:function(){return i.file.size}},file:{get:function(){return i.file}},relativePath:{get:function(){return i.file._relativePath}},source:{get:function(){return i.source}},getMetadata:function(e){return deepCloneObject(e?a[e]:a)},setMetadata:function(e,t,r){return isObject(e)?(Object.keys(e).forEach(function(r){_setMetadata(r,e[r],t)}),e):(_setMetadata(e,t,r),t)},extend:function(e,t){return l[e]=t},abortLoad:function(){if(i.activeLoader){i.activeLoader.abort();return}setStatus(E.INIT),fire("load-abort")},retryLoad:function(){i.activeLoader&&i.activeLoader.load()},requestProcessing:function(){i.processingAborted=!1,setStatus(E.PROCESSING_QUEUED)},abortProcessing:function(){return new Promise(function(e){if(!i.activeProcessor){i.processingAborted=!0,setStatus(E.IDLE),fire("process-abort"),e();return}o=function(){e()},i.activeProcessor.abort()})},load:function(t,r,n){if(i.source=t,s.fireSync("init"),i.file){s.fireSync("load-skip");return}i.file=createFileStub(t),r.on("init",function(){fire("load-init")}),r.on("meta",function(t){i.file.size=t.size,i.file.filename=t.filename,t.source&&(e=m.LIMBO,i.serverFileReference=t.source,i.status=E.PROCESSING_COMPLETE),fire("load-meta")}),r.on("progress",function(e){setStatus(E.LOADING),fire("load-progress",e)}),r.on("error",function(e){setStatus(E.LOAD_ERROR),fire("load-request-error",e)}),r.on("abort",function(){setStatus(E.INIT),fire("load-abort")}),r.on("load",function(t){i.activeLoader=null;var success=function(t){i.file=isFile(t)?t:i.file,e===m.LIMBO&&i.serverFileReference?setStatus(E.PROCESSING_COMPLETE):setStatus(E.IDLE),fire("load")};if(i.serverFileReference){success(t);return}n(t,success,function(e){i.file=t,fire("load-meta"),setStatus(E.LOAD_ERROR),fire("load-file-error",e)})}),r.setSource(t),i.activeLoader=r,r.load()},process:function process(e,t){if(i.processingAborted){i.processingAborted=!1;return}if(setStatus(E.PROCESSING),o=null,!(i.file instanceof Blob)){s.on("load",function(){process(e,t)});return}e.on("load",function(e){i.transferId=null,i.serverFileReference=e}),e.on("transfer",function(e){i.transferId=e}),e.on("load-perceived",function(e){i.activeProcessor=null,i.transferId=null,i.serverFileReference=e,setStatus(E.PROCESSING_COMPLETE),fire("process-complete",e)}),e.on("start",function(){fire("process-start")}),e.on("error",function(e){i.activeProcessor=null,setStatus(E.PROCESSING_ERROR),fire("process-error",e)}),e.on("abort",function(e){i.activeProcessor=null,i.serverFileReference=e,setStatus(E.IDLE),fire("process-abort"),o&&o()}),e.on("progress",function(e){fire("process-progress",e)});var r=console.error;t(i.file,function(t){i.archived||e.process(t,Object.assign({},a))},r),i.activeProcessor=e},revert:function(e,t){return new Promise(function(r,n){var o=null!==i.serverFileReference?i.serverFileReference:i.transferId;if(null===o){r();return}e(o,function(){i.serverFileReference=null,i.transferId=null,r()},function(e){if(!t){r();return}setStatus(E.PROCESSING_REVERT_ERROR),fire("process-revert-error"),n(e)}),setStatus(E.IDLE),fire("process-revert")})}},on(),{freeze:function(){return i.frozen=!0},release:function(){return i.released=!0},released:{get:function(){return i.released}},archive:function(){return i.archived=!0},archived:{get:function(){return i.archived}}}),l=createObject(s);return l},getItemById=function(e,t){var r=isEmpty(t)?0:isString(t)?e.findIndex(function(e){return e.id===t}):-1;if(!(r<0))return e[r]||null},fetchBlob=function(e,t,r,n,i,o){var a=sendRequest(null,e,{method:"GET",responseType:"blob"});return a.onload=function(r){var n=r.getAllResponseHeaders(),i=getFileInfoFromHeaders(n).name||getFilenameFromURL(e);t(createResponse("load",r.status,getFileFromBlob(r.response,i),n))},a.onerror=function(e){r(createResponse("error",e.status,e.statusText,e.getAllResponseHeaders()))},a.onheaders=function(e){o(createResponse("headers",e.status,null,e.getAllResponseHeaders()))},a.ontimeout=createTimeoutResponse(r),a.onprogress=n,a.onabort=i,a},getDomainFromURL=function(e){return 0===e.indexOf("//")&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]},dynamicLabel=function(e){return function(){return isFunction(e)?e.apply(void 0,arguments):e}},listUpdated=function(e,t){clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout(function(){e("DID_UPDATE_ITEMS",{items:getActiveItems(t.items)})},0)},optionalPromise=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new Promise(function(t){if(!e)return t(!0);var n=e.apply(void 0,r);return null==n?t(!0):"boolean"==typeof n?t(n):void("function"==typeof n.then&&n.then(t))})},sortItems=function(e,t){e.items.sort(function(e,r){return t(createItemAPI(e),createItemAPI(r))})},getItemByQueryFromState=function(e,t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.query,i=r.success,o=void 0===i?function(){}:i,a=r.failure,s=void 0===a?function(){}:a,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(r,["query","success","failure"]),u=getItemByQuery(e.items,n);if(!u){s({error:createResponse("error",0,"Item not found"),file:null});return}t(u,o,s,l||{})}},actions=function(e,t,r){return{ABORT_ALL:function(){getActiveItems(r.items).forEach(function(e){e.freeze(),e.abortLoad(),e.abortProcessing()})},DID_SET_FILES:function(t){var n=t.value,i=(void 0===n?[]:n).map(function(e){return{source:e.source?e.source:e,options:e.options}}),o=getActiveItems(r.items);o.forEach(function(t){i.find(function(e){return e.source===t.source||e.source===t.file})||e("REMOVE_ITEM",{query:t,remove:!1})}),o=getActiveItems(r.items),i.forEach(function(t,r){o.find(function(e){return e.source===t.source||e.file===t.source})||e("ADD_ITEM",Object.assign({},t,{interactionMethod:d.NONE,index:r}))})},DID_UPDATE_ITEM_METADATA:function(n){var i=n.id,o=n.action,a=n.change;a.silent||(clearTimeout(r.itemUpdateTimeout),r.itemUpdateTimeout=setTimeout(function(){var n,s=getItemById(r.items,i);if(!t("IS_ASYNC")){applyFilterChain("SHOULD_PREPARE_OUTPUT",!1,{item:s,query:t,action:o,change:a}).then(function(r){var n=t("GET_BEFORE_PREPARE_FILE");n&&(r=n(s,r)),r&&e("REQUEST_PREPARE_OUTPUT",{query:i,item:s,success:function(t){e("DID_PREPARE_OUTPUT",{id:i,file:t})}},!0)});return}s.origin===m.LOCAL&&e("DID_LOAD_ITEM",{id:s.id,error:null,serverFileReference:s.source});var upload=function(){setTimeout(function(){e("REQUEST_ITEM_PROCESSING",{query:i})},32)};return s.status===E.PROCESSING_COMPLETE?function(e){s.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(e?upload:function(){}).catch(function(){})}(r.options.instantUpload):s.status===E.PROCESSING?(n=r.options.instantUpload,void s.abortProcessing().then(n?upload:function(){})):void(r.options.instantUpload&&upload())},0))},MOVE_ITEM:function(e){var t=e.query,n=e.index,i=getItemByQuery(r.items,t);if(i){var o=r.items.indexOf(i);o!==(n=limit(n,0,r.items.length-1))&&r.items.splice(n,0,r.items.splice(o,1)[0])}},SORT:function(n){sortItems(r,n.compare),e("DID_SORT_ITEMS",{items:t("GET_ACTIVE_ITEMS")})},ADD_ITEMS:function(r){var n=r.items,i=r.index,o=r.interactionMethod,a=r.success,s=void 0===a?function(){}:a,l=r.failure,u=void 0===l?function(){}:l,c=i;if(-1===i||void 0===i){var f=t("GET_ITEM_INSERT_LOCATION"),d=t("GET_TOTAL_ITEMS");c="before"===f?0:d}var p=t("GET_IGNORED_FILES");Promise.all(n.filter(function(e){return isFile(e)?!p.includes(e.name.toLowerCase()):!isEmpty(e)}).map(function(t){return new Promise(function(r,n){e("ADD_ITEM",{interactionMethod:o,source:t.source||t,success:r,failure:n,index:c++,options:t.options||{}})})})).then(s).catch(u)},ADD_ITEM:function(n){var i,o=n.source,a=n.index,s=void 0===a?-1:a,l=n.interactionMethod,u=n.success,c=void 0===u?function(){}:u,f=n.failure,d=void 0===f?function(){}:f,p=n.options,I=void 0===p?{}:p;if(isEmpty(o)){d({error:createResponse("error",0,"No source"),file:null});return}if(!(isFile(o)&&r.options.ignoredFiles.includes(o.name.toLowerCase()))){if(!hasRoomForItem(r)){if(r.options.allowMultiple||!r.options.allowMultiple&&!r.options.allowReplace){var g=createResponse("warning",0,"Max files");e("DID_THROW_MAX_FILES",{source:o,error:g}),d({error:g,file:null});return}var _=getActiveItems(r.items)[0];if(_.status===E.PROCESSING_COMPLETE||_.status===E.PROCESSING_REVERT_ERROR){var T=t("GET_FORCE_REVERT");if(_.revert(createRevertFunction(r.options.server.url,r.options.server.revert),T).then(function(){T&&e("ADD_ITEM",{source:o,index:s,interactionMethod:l,success:c,failure:d,options:I})}).catch(function(){}),T)return}e("REMOVE_ITEM",{query:_.id})}var v="local"===I.type?m.LOCAL:"limbo"===I.type?m.LIMBO:m.INPUT,h=createItem(v,v===m.INPUT?null:o,I.file);Object.keys(I.metadata||{}).forEach(function(e){h.setMetadata(e,I.metadata[e])}),applyFilters("DID_CREATE_ITEM",h,{query:t,dispatch:e});var R=t("GET_ITEM_INSERT_LOCATION");r.options.itemInsertLocationFreedom||(s="before"===R?-1:r.items.length),insertItem(r.items,h,s),isFunction(R)&&o&&sortItems(r,R);var O=h.id;h.on("init",function(){e("DID_INIT_ITEM",{id:O})}),h.on("load-init",function(){e("DID_START_ITEM_LOAD",{id:O})}),h.on("load-meta",function(){e("DID_UPDATE_ITEM_META",{id:O})}),h.on("load-progress",function(t){e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:O,progress:t})}),h.on("load-request-error",function(t){var n=dynamicLabel(r.options.labelFileLoadError)(t);if(t.code>=400&&t.code<500){e("DID_THROW_ITEM_INVALID",{id:O,error:t,status:{main:n,sub:t.code+" ("+t.body+")"}}),d({error:t,file:createItemAPI(h)});return}e("DID_THROW_ITEM_LOAD_ERROR",{id:O,error:t,status:{main:n,sub:r.options.labelTapToRetry}})}),h.on("load-file-error",function(t){e("DID_THROW_ITEM_INVALID",{id:O,error:t.status,status:t.status}),d({error:t.status,file:createItemAPI(h)})}),h.on("load-abort",function(){e("REMOVE_ITEM",{query:O})}),h.on("load-skip",function(){e("COMPLETE_LOAD_ITEM",{query:O,item:h,data:{source:o,success:c}})}),h.on("load",function(){var handleAdd=function(n){if(!n){e("REMOVE_ITEM",{query:O});return}h.on("metadata-update",function(t){e("DID_UPDATE_ITEM_METADATA",{id:O,change:t})}),applyFilterChain("SHOULD_PREPARE_OUTPUT",!1,{item:h,query:t}).then(function(n){var i=t("GET_BEFORE_PREPARE_FILE");i&&(n=i(h,n));var loadComplete=function(){e("COMPLETE_LOAD_ITEM",{query:O,item:h,data:{source:o,success:c}}),listUpdated(e,r)};if(n){e("REQUEST_PREPARE_OUTPUT",{query:O,item:h,success:function(t){e("DID_PREPARE_OUTPUT",{id:O,file:t}),loadComplete()}},!0);return}loadComplete()})};applyFilterChain("DID_LOAD_ITEM",h,{query:t,dispatch:e}).then(function(){optionalPromise(t("GET_BEFORE_ADD_FILE"),createItemAPI(h)).then(handleAdd)}).catch(function(t){if(!t||!t.error||!t.status)return handleAdd(!1);e("DID_THROW_ITEM_INVALID",{id:O,error:t.error,status:t.status})})}),h.on("process-start",function(){e("DID_START_ITEM_PROCESSING",{id:O})}),h.on("process-progress",function(t){e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:O,progress:t})}),h.on("process-error",function(t){e("DID_THROW_ITEM_PROCESSING_ERROR",{id:O,error:t,status:{main:dynamicLabel(r.options.labelFileProcessingError)(t),sub:r.options.labelTapToRetry}})}),h.on("process-revert-error",function(t){e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:O,error:t,status:{main:dynamicLabel(r.options.labelFileProcessingRevertError)(t),sub:r.options.labelTapToRetry}})}),h.on("process-complete",function(t){e("DID_COMPLETE_ITEM_PROCESSING",{id:O,error:null,serverFileReference:t}),e("DID_DEFINE_VALUE",{id:O,value:t})}),h.on("process-abort",function(){e("DID_ABORT_ITEM_PROCESSING",{id:O})}),h.on("process-revert",function(){e("DID_REVERT_ITEM_PROCESSING",{id:O}),e("DID_DEFINE_VALUE",{id:O,value:null})}),e("DID_ADD_ITEM",{id:O,index:s,interactionMethod:l}),listUpdated(e,r);var y=r.options.server||{},D=y.url,S=y.load,A=y.restore,b=y.fetch;h.load(o,createFileLoader(v===m.INPUT?isString(o)&&((i=o).indexOf(":")>-1||i.indexOf("//")>-1)&&getDomainFromURL(location.href)!==getDomainFromURL(i)&&b?createFetchFunction(D,b):fetchBlob:v===m.LIMBO?createFetchFunction(D,A):createFetchFunction(D,S)),function(e,r,n){applyFilterChain("LOAD_FILE",e,{query:t}).then(r).catch(n)})}},REQUEST_PREPARE_OUTPUT:function(e){var r=e.item,n=e.success,i=e.failure,o=void 0===i?function(){}:i,a={error:createResponse("error",0,"Item not found"),file:null};if(r.archived)return o(a);applyFilterChain("PREPARE_OUTPUT",r.file,{query:t,item:r}).then(function(e){applyFilterChain("COMPLETE_PREPARE_OUTPUT",e,{query:t,item:r}).then(function(e){if(r.archived)return o(a);n(e)})})},COMPLETE_LOAD_ITEM:function(n){var i=n.item,o=n.data,a=o.success,s=o.source,l=t("GET_ITEM_INSERT_LOCATION");if(isFunction(l)&&s&&sortItems(r,l),e("DID_LOAD_ITEM",{id:i.id,error:null,serverFileReference:i.origin===m.INPUT?null:s}),a(createItemAPI(i)),i.origin===m.LOCAL){e("DID_LOAD_LOCAL_ITEM",{id:i.id});return}if(i.origin===m.LIMBO){e("DID_COMPLETE_ITEM_PROCESSING",{id:i.id,error:null,serverFileReference:s}),e("DID_DEFINE_VALUE",{id:i.id,value:i.serverId||s});return}t("IS_ASYNC")&&r.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:i.id})},RETRY_ITEM_LOAD:getItemByQueryFromState(r,function(e){e.retryLoad()}),REQUEST_ITEM_PREPARE:getItemByQueryFromState(r,function(t,r,n){e("REQUEST_PREPARE_OUTPUT",{query:t.id,item:t,success:function(n){e("DID_PREPARE_OUTPUT",{id:t.id,file:n}),r({file:t,output:n})},failure:n},!0)}),REQUEST_ITEM_PROCESSING:getItemByQueryFromState(r,function(n,i,o){if(!(n.status===E.IDLE||n.status===E.PROCESSING_ERROR)){var processNow=function(){return e("REQUEST_ITEM_PROCESSING",{query:n,success:i,failure:o})},process=function(){return document.hidden?processNow():setTimeout(processNow,32)};n.status===E.PROCESSING_COMPLETE||n.status===E.PROCESSING_REVERT_ERROR?n.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(process).catch(function(){}):n.status===E.PROCESSING&&n.abortProcessing().then(process);return}n.status!==E.PROCESSING_QUEUED&&(n.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:n.id}),e("PROCESS_ITEM",{query:n,success:i,failure:o},!0))}),PROCESS_ITEM:getItemByQueryFromState(r,function(n,i,o){var a=t("GET_MAX_PARALLEL_UPLOADS");if(t("GET_ITEMS_BY_STATUS",E.PROCESSING).length===a){r.processingQueue.push({id:n.id,success:i,failure:o});return}if(n.status!==E.PROCESSING){var processNext=function processNext(){var t=r.processingQueue.shift();if(t){var n=t.id,i=t.success,o=t.failure,a=getItemByQuery(r.items,n);if(!a||a.archived){processNext();return}e("PROCESS_ITEM",{query:n,success:i,failure:o},!0)}};n.onOnce("process-complete",function(){i(createItemAPI(n)),processNext();var o=r.options.server;if(r.options.instantUpload&&n.origin===m.LOCAL&&isFunction(o.remove)){var noop=function(){};n.origin=m.LIMBO,r.options.server.remove(n.source,noop,noop)}t("GET_ITEMS_BY_STATUS",E.PROCESSING_COMPLETE).length===r.items.length&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")}),n.onOnce("process-error",function(e){o({error:e,file:createItemAPI(n)}),processNext()});var s=r.options;n.process(createFileProcessor(createProcessorFunction(s.server.url,s.server.process,s.name,{chunkTransferId:n.transferId,chunkServer:s.server.patch,chunkUploads:s.chunkUploads,chunkForce:s.chunkForce,chunkSize:s.chunkSize,chunkRetryDelays:s.chunkRetryDelays}),{allowMinimumUploadDuration:t("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),function(r,i,o){applyFilterChain("PREPARE_OUTPUT",r,{query:t,item:n}).then(function(t){e("DID_PREPARE_OUTPUT",{id:n.id,file:t}),i(t)}).catch(o)})}}),RETRY_ITEM_PROCESSING:getItemByQueryFromState(r,function(t){e("REQUEST_ITEM_PROCESSING",{query:t})}),REQUEST_REMOVE_ITEM:getItemByQueryFromState(r,function(r){optionalPromise(t("GET_BEFORE_REMOVE_FILE"),createItemAPI(r)).then(function(t){t&&e("REMOVE_ITEM",{query:r})})}),RELEASE_ITEM:getItemByQueryFromState(r,function(e){e.release()}),REMOVE_ITEM:getItemByQueryFromState(r,function(n,i,o,a){var removeFromView=function(){var t=n.id;getItemById(r.items,t).archive(),e("DID_REMOVE_ITEM",{error:null,id:t,item:n}),listUpdated(e,r),i(createItemAPI(n))},s=r.options.server;n.origin===m.LOCAL&&s&&isFunction(s.remove)&&!1!==a.remove?(e("DID_START_ITEM_REMOVE",{id:n.id}),s.remove(n.source,function(){return removeFromView()},function(t){e("DID_THROW_ITEM_REMOVE_ERROR",{id:n.id,error:createResponse("error",0,t,null),status:{main:dynamicLabel(r.options.labelFileRemoveError)(t),sub:r.options.labelTapToRetry}})})):((a.revert&&n.origin!==m.LOCAL&&null!==n.serverId||r.options.chunkUploads&&n.file.size>r.options.chunkSize||r.options.chunkUploads&&r.options.chunkForce)&&n.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")),removeFromView())}),ABORT_ITEM_LOAD:getItemByQueryFromState(r,function(e){e.abortLoad()}),ABORT_ITEM_PROCESSING:getItemByQueryFromState(r,function(t){if(t.serverId){e("REVERT_ITEM_PROCESSING",{id:t.id});return}t.abortProcessing().then(function(){r.options.instantUpload&&e("REMOVE_ITEM",{query:t.id})})}),REQUEST_REVERT_ITEM_PROCESSING:getItemByQueryFromState(r,function(n){if(!r.options.instantUpload){e("REVERT_ITEM_PROCESSING",{query:n});return}var handleRevert=function(t){t&&e("REVERT_ITEM_PROCESSING",{query:n})},i=t("GET_BEFORE_REMOVE_FILE");if(!i)return handleRevert(!0);var o=i(createItemAPI(n));return null==o?handleRevert(!0):"boolean"==typeof o?handleRevert(o):void("function"==typeof o.then&&o.then(handleRevert))}),REVERT_ITEM_PROCESSING:getItemByQueryFromState(r,function(n){n.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(function(){(r.options.instantUpload||!isFile(n.file))&&e("REMOVE_ITEM",{query:n.id})}).catch(function(){})}),SET_OPTIONS:function(t){var r=t.options,n=Object.keys(r),i=D.filter(function(e){return n.includes(e)});[].concat(_toConsumableArray(i),_toConsumableArray(Object.keys(r).filter(function(e){return!i.includes(e)}))).forEach(function(t){e("SET_"+fromCamels(t,"_").toUpperCase(),{value:r[t]})})}}},D=["server"],formatFilename=function(e){return e},createElement$1=function(e){return document.createElement(e)},text=function(e,t){var r=e.childNodes[0];r?t!==r.nodeValue&&(r.nodeValue=t):(r=document.createTextNode(t),e.appendChild(r))},polarToCartesian=function(e,t,r,n){var i=(n%360-90)*Math.PI/180;return{x:e+r*Math.cos(i),y:t+r*Math.sin(i)}},describeArc=function(e,t,r,n,i,o){var a=polarToCartesian(e,t,r,i),s=polarToCartesian(e,t,r,n);return["M",a.x,a.y,"A",r,r,0,o,0,s.x,s.y].join(" ")},percentageArc=function(e,t,r,n,i){var o=1;return i>n&&i-n<=.5&&(o=0),n>i&&n-i>=.5&&(o=0),describeArc(e,t,r,360*Math.min(.9999,n),360*Math.min(.9999,i),o)},S=createView({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:function(e){var t=e.root,r=e.props;r.spin=!1,r.progress=0,r.opacity=0;var n=createElement("svg");t.ref.path=createElement("path",{"stroke-width":2,"stroke-linecap":"round"}),n.appendChild(t.ref.path),t.ref.svg=n,t.appendChild(n)},write:function(e){var t=e.root,r=e.props;if(0!==r.opacity){r.align&&(t.element.dataset.align=r.align);var n=parseInt(attr(t.ref.path,"stroke-width"),10),i=.5*t.rect.element.width,o=0,a=0;r.spin?(o=0,a=.5):(o=0,a=r.progress);var s=percentageArc(i,i,i-n,o,a);attr(t.ref.path,"d",s),attr(t.ref.path,"stroke-opacity",r.spin||r.progress>0?1:0)}},mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),A=createView({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:function(e){var t=e.root,r=e.props;t.element.innerHTML=(r.icon||"")+"<span>"+r.label+"</span>",r.isDisabled=!1},write:function(e){var t=e.root,r=e.props,n=r.isDisabled,i=t.query("GET_DISABLED")||0===r.opacity;i&&!n?(r.isDisabled=!0,attr(t.element,"disabled","disabled")):!i&&n&&(r.isDisabled=!1,t.element.removeAttribute("disabled"))}}),toNaturalFileSize=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.labelBytes,o=n.labelKilobytes,a=n.labelMegabytes,s=n.labelGigabytes,l=r*r,u=r*r*r;return(e=Math.round(Math.abs(e)))<r?e+" "+(void 0===i?"bytes":i):e<l?Math.floor(e/r)+" "+(void 0===o?"KB":o):e<u?removeDecimalsWhenZero(e/l,1,t)+" "+(void 0===a?"MB":a):removeDecimalsWhenZero(e/u,2,t)+" "+(void 0===s?"GB":s)},removeDecimalsWhenZero=function(e,t,r){return e.toFixed(t).split(".").filter(function(e){return"0"!==e}).join(r)},updateFile=function(e){var t=e.root,r=e.props;text(t.ref.fileSize,toNaturalFileSize(t.query("GET_ITEM_SIZE",r.id),".",t.query("GET_FILE_SIZE_BASE"),t.query("GET_FILE_SIZE_LABELS",t.query))),text(t.ref.fileName,formatFilename(t.query("GET_ITEM_NAME",r.id)))},updateFileSizeOnError=function(e){var t=e.root,r=e.props;if(isInt(t.query("GET_ITEM_SIZE",r.id))){updateFile({root:t,props:r});return}text(t.ref.fileSize,t.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},b=createView({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:createRoute({DID_LOAD_ITEM:updateFile,DID_UPDATE_ITEM_META:updateFile,DID_THROW_ITEM_LOAD_ERROR:updateFileSizeOnError,DID_THROW_ITEM_INVALID:updateFileSizeOnError}),didCreateView:function(e){applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},create:function(e){var t=e.root,r=e.props,n=createElement$1("span");n.className="filepond--file-info-main",attr(n,"aria-hidden","true"),t.appendChild(n),t.ref.fileName=n;var i=createElement$1("span");i.className="filepond--file-info-sub",t.appendChild(i),t.ref.fileSize=i,text(i,t.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),text(n,formatFilename(t.query("GET_ITEM_NAME",r.id)))},mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),toPercentage=function(e){return Math.round(100*e)},didSetItemLoadProgress=function(e){var t=e.root,r=e.action,n=null===r.progress?t.query("GET_LABEL_FILE_LOADING"):t.query("GET_LABEL_FILE_LOADING")+" "+toPercentage(r.progress)+"%";text(t.ref.main,n),text(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},clear=function(e){var t=e.root;text(t.ref.main,""),text(t.ref.sub,"")},error=function(e){var t=e.root,r=e.action;text(t.ref.main,r.status.main),text(t.ref.sub,r.status.sub)},P=createView({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:createRoute({DID_LOAD_ITEM:clear,DID_REVERT_ITEM_PROCESSING:clear,DID_REQUEST_ITEM_PROCESSING:function(e){var t=e.root;text(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING")),text(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},DID_ABORT_ITEM_PROCESSING:function(e){var t=e.root;text(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_ABORTED")),text(t.ref.sub,t.query("GET_LABEL_TAP_TO_RETRY"))},DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root;text(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),text(t.ref.sub,t.query("GET_LABEL_TAP_TO_UNDO"))},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(e){var t=e.root,r=e.action,n=null===r.progress?t.query("GET_LABEL_FILE_PROCESSING"):t.query("GET_LABEL_FILE_PROCESSING")+" "+toPercentage(r.progress)+"%";text(t.ref.main,n),text(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},DID_UPDATE_ITEM_LOAD_PROGRESS:didSetItemLoadProgress,DID_THROW_ITEM_LOAD_ERROR:error,DID_THROW_ITEM_INVALID:error,DID_THROW_ITEM_PROCESSING_ERROR:error,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:error,DID_THROW_ITEM_REMOVE_ERROR:error}),didCreateView:function(e){applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},create:function(e){var t=e.root,r=createElement$1("span");r.className="filepond--file-status-main",t.appendChild(r),t.ref.main=r;var n=createElement$1("span");n.className="filepond--file-status-sub",t.appendChild(n),t.ref.sub=n,didSetItemLoadProgress({root:t,action:{progress:null}})},mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),L={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},C=[];forin(L,function(e){C.push(e)});var calculateFileInfoOffset=function(e){if("right"===getRemoveIndicatorAligment(e))return 0;var t=e.ref.buttonRemoveItem.rect.element;return t.hidden?null:t.width+t.left},calculateButtonWidth=function(e){return e.ref.buttonAbortItemLoad.rect.element.width},calculateFileVerticalCenterOffset=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.height/4)},calculateFileHorizontalCenterOffset=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.left/2)},getRemoveIndicatorAligment=function(e){return e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION")},M={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:function(e){return e.query("GET_STYLE_LOAD_INDICATOR_POSITION")}},processProgressIndicator:{opacity:0,align:function(e){return e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},N={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset}},w={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},F={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:getRemoveIndicatorAligment},info:{translateX:calculateFileInfoOffset},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:getRemoveIndicatorAligment},buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1,translateX:calculateFileInfoOffset}},DID_LOAD_ITEM:N,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset}},DID_START_ITEM_PROCESSING:w,DID_REQUEST_ITEM_PROCESSING:w,DID_UPDATE_ITEM_PROCESS_PROGRESS:w,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:calculateFileInfoOffset}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:N},G=createView({create:function(e){var t=e.root;t.element.innerHTML=t.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),B=createRoute({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:function(e){var t=e.root,r=e.action;t.ref.buttonAbortItemProcessing.label=r.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:function(e){var t=e.root,r=e.action;t.ref.buttonAbortItemLoad.label=r.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:function(e){var t=e.root,r=e.action;t.ref.buttonAbortItemRemoval.label=r.value},DID_REQUEST_ITEM_PROCESSING:function(e){var t=e.root;t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:function(e){var t=e.root;t.ref.loadProgressIndicator.spin=!0,t.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:function(e){var t=e.root;t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:function(e){var t=e.root,r=e.action;t.ref.loadProgressIndicator.spin=!1,t.ref.loadProgressIndicator.progress=r.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(e){var t=e.root,r=e.action;t.ref.processProgressIndicator.spin=!1,t.ref.processProgressIndicator.progress=r.progress}}),U=createView({create:function(e){var t,r=e.root,n=e.props,i=Object.keys(L).reduce(function(e,t){return e[t]=Object.assign({},L[t]),e},{}),o=n.id,a=r.query("GET_ALLOW_REVERT"),s=r.query("GET_ALLOW_REMOVE"),l=r.query("GET_ALLOW_PROCESS"),u=r.query("GET_INSTANT_UPLOAD"),c=r.query("IS_ASYNC"),f=r.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");c?l&&!a?t=function(e){return!/RevertItemProcessing/.test(e)}:!l&&a?t=function(e){return!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(e)}:l||a||(t=function(e){return!/Process/.test(e)}):t=function(e){return!/Process/.test(e)};var d=t?C.filter(t):C.concat();if(u&&a&&(i.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",i.RevertItemProcessing.icon="GET_ICON_REMOVE"),c&&!a){var p=F.DID_COMPLETE_ITEM_PROCESSING;p.info.translateX=calculateFileHorizontalCenterOffset,p.info.translateY=calculateFileVerticalCenterOffset,p.status.translateY=calculateFileVerticalCenterOffset,p.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(c&&!l&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(function(e){F[e].status.translateY=calculateFileVerticalCenterOffset}),F.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=calculateButtonWidth),f&&a){i.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";var E=F.DID_COMPLETE_ITEM_PROCESSING;E.info.translateX=calculateFileInfoOffset,E.status.translateY=calculateFileVerticalCenterOffset,E.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}s||(i.RemoveItem.disabled=!0),forin(i,function(e,t){var n=r.createChildView(A,{label:r.query(t.label),icon:r.query(t.icon),opacity:0});d.includes(e)&&r.appendChildView(n),t.disabled&&(n.element.setAttribute("disabled","disabled"),n.element.setAttribute("hidden","hidden")),n.element.dataset.align=r.query("GET_STYLE_"+t.align),n.element.classList.add(t.className),n.on("click",function(e){e.stopPropagation(),t.disabled||r.dispatch(t.action,{query:o})}),r.ref["button"+e]=n}),r.ref.processingCompleteIndicator=r.appendChildView(r.createChildView(G)),r.ref.processingCompleteIndicator.element.dataset.align=r.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),r.ref.info=r.appendChildView(r.createChildView(b,{id:o})),r.ref.status=r.appendChildView(r.createChildView(P,{id:o}));var m=r.appendChildView(r.createChildView(S,{opacity:0,align:r.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));m.element.classList.add("filepond--load-indicator"),r.ref.loadProgressIndicator=m;var I=r.appendChildView(r.createChildView(S,{opacity:0,align:r.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));I.element.classList.add("filepond--process-indicator"),r.ref.processProgressIndicator=I,r.ref.activeStyles=[]},write:function(e){var t=e.root,r=e.actions;B({root:t,actions:r,props:e.props});var n=r.concat().filter(function(e){return/^DID_/.test(e.type)}).reverse().find(function(e){return F[e.type]});if(n){t.ref.activeStyles=[];var i=F[n.type];forin(M,function(e,r){var n=t.ref[e];forin(r,function(r,o){var a=i[e]&&void 0!==i[e][r]?i[e][r]:o;t.ref.activeStyles.push({control:n,key:r,value:a})})})}t.ref.activeStyles.forEach(function(e){var r=e.control,n=e.key,i=e.value;r[n]="function"==typeof i?i(t):i})},didCreateView:function(e){applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},name:"file"}),x=createView({create:function(e){var t=e.root,r=e.props;t.ref.fileName=createElement$1("legend"),t.appendChild(t.ref.fileName),t.ref.file=t.appendChildView(t.createChildView(U,{id:r.id})),t.ref.data=!1},ignoreRect:!0,write:createRoute({DID_LOAD_ITEM:function(e){var t=e.root,r=e.props;text(t.ref.fileName,formatFilename(t.query("GET_ITEM_NAME",r.id)))}}),didCreateView:function(e){applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},tag:"fieldset",name:"file-wrapper"}),V={type:"spring",damping:.6,mass:7},createSection=function(e,t,r){var n=createView({name:"panel-"+t.name+" filepond--"+r,mixins:t.mixins,ignoreRectUpdate:!0}),i=e.createChildView(n,t.props);e.ref[t.name]=e.appendChildView(i)},q=createView({name:"panel",read:function(e){var t=e.root;return e.props.heightCurrent=t.ref.bottom.translateY},write:function(e){var t=e.root,r=e.props;if((null===t.ref.scalable||r.scalable!==t.ref.scalable)&&(t.ref.scalable=!isBoolean(r.scalable)||r.scalable,t.element.dataset.scalable=t.ref.scalable),r.height){var n=t.ref.top.rect.element,i=t.ref.bottom.rect.element,o=Math.max(n.height+i.height,r.height);t.ref.center.translateY=n.height,t.ref.center.scaleY=(o-n.height-i.height)/100,t.ref.bottom.translateY=o-i.height}},create:function(e){var t=e.root,r=e.props;[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:V},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:V},styles:["translateY"]}}].forEach(function(e){createSection(t,e,r.name)}),t.element.classList.add("filepond--"+r.name),t.ref.scalable=null},ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),createDragHelper=function(e){var t=e.map(function(e){return e.id}),r=void 0;return{setIndex:function(e){r=e},getIndex:function(){return r},getItemIndex:function(e){return t.indexOf(e.id)}}},j={type:"spring",stiffness:.75,damping:.45,mass:10},Y="spring",k={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},H=createRoute({DID_UPDATE_PANEL_HEIGHT:function(e){var t=e.root,r=e.action;t.height=r.height}}),W=createView({create:function(e){var t=e.root,r=e.props;t.ref.handleClick=function(e){return t.dispatch("DID_ACTIVATE_ITEM",{id:r.id})},t.element.id="filepond--item-"+r.id,t.element.addEventListener("click",t.ref.handleClick),t.ref.container=t.appendChildView(t.createChildView(x,{id:r.id})),t.ref.panel=t.appendChildView(t.createChildView(q,{name:"item-panel"})),t.ref.panel.height=null,r.markedForRemoval=!1,t.query("GET_ALLOW_REORDER")&&(t.element.dataset.dragState="idle",t.element.addEventListener("pointerdown",function(e){if(e.isPrimary){var n=!1,i={x:e.pageX,y:e.pageY};r.dragOrigin={x:t.translateX,y:t.translateY},r.dragCenter={x:e.offsetX,y:e.offsetY};var o=createDragHelper(t.query("GET_ACTIVE_ITEMS"));t.dispatch("DID_GRAB_ITEM",{id:r.id,dragState:o});var drag=function(e){e.isPrimary&&(e.stopPropagation(),e.preventDefault(),r.dragOffset={x:e.pageX-i.x,y:e.pageY-i.y},r.dragOffset.x*r.dragOffset.x+r.dragOffset.y*r.dragOffset.y>16&&!n&&(n=!0,t.element.removeEventListener("click",t.ref.handleClick)),t.dispatch("DID_DRAG_ITEM",{id:r.id,dragState:o}))};document.addEventListener("pointermove",drag),document.addEventListener("pointerup",function drop(e){e.isPrimary&&(document.removeEventListener("pointermove",drag),document.removeEventListener("pointerup",drop),r.dragOffset={x:e.pageX-i.x,y:e.pageY-i.y},t.dispatch("DID_DROP_ITEM",{id:r.id,dragState:o}),n&&setTimeout(function(){return t.element.addEventListener("click",t.ref.handleClick)},0))})}}))},write:createRoute({DID_GRAB_ITEM:function(e){var t=e.root;e.props.dragOrigin={x:t.translateX,y:t.translateY}},DID_DRAG_ITEM:function(e){e.root.element.dataset.dragState="drag"},DID_DROP_ITEM:function(e){var t=e.root,r=e.props;r.dragOffset=null,r.dragOrigin=null,t.element.dataset.dragState="drop"}},function(e){var t=e.root,r=e.actions,n=e.props,i=e.shouldOptimize;"drop"===t.element.dataset.dragState&&t.scaleX<=1&&(t.element.dataset.dragState="idle");var o=r.concat().filter(function(e){return/^DID_/.test(e.type)}).reverse().find(function(e){return k[e.type]});o&&o.type!==n.currentState&&(n.currentState=o.type,t.element.dataset.filepondItemState=k[n.currentState]||"");var a=t.query("GET_ITEM_PANEL_ASPECT_RATIO")||t.query("GET_PANEL_ASPECT_RATIO");a?i||(t.height=t.rect.element.width*a):(H({root:t,actions:r,props:n}),!t.height&&t.ref.container.rect.element.height>0&&(t.height=t.ref.container.rect.element.height)),i&&(t.ref.panel.height=null),t.ref.panel.height=t.height}),destroy:function(e){var t=e.root,r=e.props;t.element.removeEventListener("click",t.ref.handleClick),t.dispatch("RELEASE_ITEM",{query:r.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:Y,scaleY:Y,translateX:j,translateY:j,opacity:{type:"tween",duration:150}}}}),getItemsPerRow=function(e,t){return Math.max(1,Math.floor((e+1)/t))},getItemIndexByPosition=function(e,t,r){if(r){var n=e.rect.element.width,i=t.length,o=null;if(0===i||r.top<t[0].rect.element.top)return -1;var a=t[0].rect.element,s=a.marginLeft+a.marginRight,l=a.width+s,u=getItemsPerRow(n,l);if(1===u){for(var c=0;c<i;c++){var f=t[c],d=f.rect.outer.top+.5*f.rect.element.height;if(r.top<d)return c}return i}for(var p=a.marginTop+a.marginBottom,E=a.height+p,m=0;m<i;m++){var I=m%u*l,g=Math.floor(m/u)*E,_=g-a.marginTop,T=I+l,v=g+E+a.marginBottom;if(r.top<v&&r.top>_){if(r.left<T)return m;o=m!==i-1?m:null}}return null!==o?o:i}},z={height:0,width:0,get getHeight(){return this.height},set setHeight(val){(0===this.height||0===val)&&(this.height=val)},get getWidth(){return this.width},set setWidth(val){(0===this.width||0===val)&&(this.width=val)}},moveItem=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.dragOffset?(e.translateX=null,e.translateY=null,e.translateX=e.dragOrigin.x+e.dragOffset.x,e.translateY=e.dragOrigin.y+e.dragOffset.y,e.scaleX=1.025,e.scaleY=1.025):(e.translateX=t,e.translateY=r,Date.now()>e.spawnDate&&(0===e.opacity&&introItemView(e,t,r,n,i),e.scaleX=1,e.scaleY=1,e.opacity=1))},introItemView=function(e,t,r,n,i){e.interactionMethod===d.NONE?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=r):e.interactionMethod===d.DROP?(e.translateX=null,e.translateX=t-20*n,e.translateY=null,e.translateY=r-10*i,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===d.BROWSE?(e.translateY=null,e.translateY=r-30):e.interactionMethod===d.API&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},getItemHeight=function(e){return e.rect.element.height+.5*e.rect.element.marginBottom+.5*e.rect.element.marginTop},X=createRoute({DID_ADD_ITEM:function(e){var t=e.root,r=e.action,n=r.id,i=r.index,o=r.interactionMethod;t.ref.addIndex=i;var a=Date.now(),s=a,l=1;if(o!==d.NONE){l=0;var u=t.query("GET_ITEM_INSERT_INTERVAL"),c=a-t.ref.lastItemSpanwDate;s=c<u?a+(u-c):a}t.ref.lastItemSpanwDate=s,t.appendChildView(t.createChildView(W,{spawnDate:s,id:n,opacity:l,interactionMethod:o}),i)},DID_REMOVE_ITEM:function(e){var t=e.root,r=e.action.id,n=t.childViews.find(function(e){return e.id===r});n&&(n.scaleX=.9,n.scaleY=.9,n.opacity=0,n.markedForRemoval=!0)},DID_DRAG_ITEM:function(e){var t=e.root,r=e.action,n=r.id,i=r.dragState,o=t.query("GET_ITEM",{id:n}),a=t.childViews.find(function(e){return e.id===n}),s=t.childViews.length,l=i.getItemIndex(o);if(a){var u={x:a.dragOrigin.x+a.dragOffset.x+a.dragCenter.x,y:a.dragOrigin.y+a.dragOffset.y+a.dragCenter.y},c=getItemHeight(a),f=a.rect.element.width+.5*a.rect.element.marginLeft+.5*a.rect.element.marginRight,d=Math.floor(t.rect.outer.width/f);d>s&&(d=s);var p=Math.floor(s/d+1);z.setHeight=c*p,z.setWidth=f*d;var E={y:Math.floor(u.y/c),x:Math.floor(u.x/f),getGridIndex:function(){return u.y>z.getHeight||u.y<0||u.x>z.getWidth||u.x<0?l:this.y*d+this.x},getColIndex:function(){for(var e=t.query("GET_ACTIVE_ITEMS"),r=t.childViews.filter(function(e){return e.rect.element.height}),n=e.map(function(e){return r.find(function(t){return t.id===e.id})}),i=n.findIndex(function(e){return e===a}),o=getItemHeight(a),s=n.length,l=s,c=0,f=0,d=0,p=0;p<s;p++)if(c=getItemHeight(n[p]),f=(d=f)+c,u.y<f){if(i>p){if(u.y<d+o){l=p;break}continue}l=p;break}return l}},m=d>1?E.getGridIndex():E.getColIndex();t.dispatch("MOVE_ITEM",{query:a,index:m});var I=i.getIndex();if(void 0===I||I!==m){if(i.setIndex(m),void 0===I)return;t.dispatch("DID_REORDER_ITEMS",{items:t.query("GET_ACTIVE_ITEMS"),origin:l,target:m})}}}}),Q=createView({create:function(e){var t=e.root;attr(t.element,"role","list"),t.ref.lastItemSpanwDate=Date.now()},write:function(e){var t=e.root,r=e.props,n=e.actions,i=e.shouldOptimize;X({root:t,props:r,actions:n});var o=r.dragCoordinates,a=t.rect.element.width,s=t.childViews.filter(function(e){return e.rect.element.height}),l=t.query("GET_ACTIVE_ITEMS").map(function(e){return s.find(function(t){return t.id===e.id})}).filter(function(e){return e}),u=o?getItemIndexByPosition(t,l,o):null,c=t.ref.addIndex||null;t.ref.addIndex=null;var f=0,d=0,p=0;if(0!==l.length){var E=l[0].rect.element,m=E.marginTop+E.marginBottom,I=E.marginLeft+E.marginRight,g=E.width+I,_=E.height+m,T=getItemsPerRow(a,g);if(1===T){var v=0,h=0;l.forEach(function(e,t){if(u){var r=t-u;h=-2===r?-(.25*m):-1===r?-(.75*m):0===r?.75*m:1===r?.25*m:0}i&&(e.translateX=null,e.translateY=null),e.markedForRemoval||moveItem(e,0,v+h);var n=(e.rect.element.height+m)*(e.markedForRemoval?e.opacity:1);v+=n})}else{var R=0,O=0;l.forEach(function(e,t){t===u&&(f=1),t===c&&(p+=1),e.markedForRemoval&&e.opacity<.5&&(d-=1);var r=t+p+f+d,n=r%T*g,o=Math.floor(r/T)*_,a=Math.sign(n-R),s=Math.sign(o-O);R=n,O=o,e.markedForRemoval||(i&&(e.translateX=null,e.translateY=null),moveItem(e,n,o,a,s))})}}},tag:"ul",name:"list",didWriteView:function(e){var t=e.root;t.childViews.filter(function(e){return e.markedForRemoval&&0===e.opacity&&e.resting}).forEach(function(e){e._destroy(),t.removeChildView(e)})},filterFrameActionsForChild:function(e,t){return t.filter(function(t){return!t.data||!t.data.id||e.id===t.data.id})},mixins:{apis:["dragCoordinates"]}}),$=createRoute({DID_DRAG:function(e){var t=e.root,r=e.props,n=e.action;t.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(r.dragCoordinates={left:n.position.scopeLeft-t.ref.list.rect.element.left,top:n.position.scopeTop-(t.rect.outer.top+t.rect.element.marginTop+t.rect.element.scrollTop)})},DID_END_DRAG:function(e){e.props.dragCoordinates=null}}),Z=createView({create:function(e){var t=e.root,r=e.props;t.ref.list=t.appendChildView(t.createChildView(Q)),r.dragCoordinates=null,r.overflowing=!1},write:function(e){var t=e.root,r=e.props;if($({root:t,props:r,actions:e.actions}),t.ref.list.dragCoordinates=r.dragCoordinates,r.overflowing&&!r.overflow&&(r.overflowing=!1,t.element.dataset.state="",t.height=null),r.overflow){var n=Math.round(r.overflow);n!==t.height&&(r.overflowing=!0,t.element.dataset.state="overflow",t.height=n)}},name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),attrToggle=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";r?attr(e,t,n):e.removeAttribute(t)},resetFileInput=function(e){if(e&&""!==e.value){try{e.value=""}catch(e){}if(e.value){var t=createElement$1("form"),r=e.parentNode,n=e.nextSibling;t.appendChild(e),t.reset(),n?r.insertBefore(e,n):r.appendChild(e)}}},setAcceptedFileTypes=function(e){var t=e.root,r=e.action;t.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&attrToggle(t.element,"accept",!!r.value,r.value?r.value.join(","):"")},toggleAllowMultiple=function(e){var t=e.root,r=e.action;attrToggle(t.element,"multiple",r.value)},toggleDirectoryFilter=function(e){var t=e.root,r=e.action;attrToggle(t.element,"webkitdirectory",r.value)},toggleDisabled=function(e){var t=e.root,r=t.query("GET_DISABLED"),n=t.query("GET_ALLOW_BROWSE"),i=r||!n;attrToggle(t.element,"disabled",i)},toggleRequired=function(e){var t=e.root;e.action.value?0===t.query("GET_TOTAL_ITEMS")&&attrToggle(t.element,"required",!0):attrToggle(t.element,"required",!1)},setCaptureMethod=function(e){var t=e.root,r=e.action;attrToggle(t.element,"capture",!!r.value,!0===r.value?"":r.value)},updateRequiredStatus=function(e){var t=e.root,r=t.element;t.query("GET_TOTAL_ITEMS")>0?(attrToggle(r,"required",!1),attrToggle(r,"name",!1)):(attrToggle(r,"name",!0,t.query("GET_NAME")),t.query("GET_CHECK_VALIDITY")&&r.setCustomValidity(""),t.query("GET_REQUIRED")&&attrToggle(r,"required",!0))},K=createView({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:function(e){var t=e.root,r=e.props;t.element.id="filepond--browser-"+r.id,attr(t.element,"name",t.query("GET_NAME")),attr(t.element,"aria-controls","filepond--assistant-"+r.id),attr(t.element,"aria-labelledby","filepond--drop-label-"+r.id),setAcceptedFileTypes({root:t,action:{value:t.query("GET_ACCEPTED_FILE_TYPES")}}),toggleAllowMultiple({root:t,action:{value:t.query("GET_ALLOW_MULTIPLE")}}),toggleDirectoryFilter({root:t,action:{value:t.query("GET_ALLOW_DIRECTORIES_ONLY")}}),toggleDisabled({root:t}),toggleRequired({root:t,action:{value:t.query("GET_REQUIRED")}}),setCaptureMethod({root:t,action:{value:t.query("GET_CAPTURE_METHOD")}}),t.ref.handleChange=function(e){if(t.element.value){var n=Array.from(t.element.files).map(function(e){return e._relativePath=e.webkitRelativePath,e});setTimeout(function(){r.onload(n),resetFileInput(t.element)},250)}},t.element.addEventListener("change",t.ref.handleChange)},destroy:function(e){var t=e.root;t.element.removeEventListener("change",t.ref.handleChange)},write:createRoute({DID_LOAD_ITEM:updateRequiredStatus,DID_REMOVE_ITEM:updateRequiredStatus,DID_THROW_ITEM_INVALID:function(e){var t=e.root;t.query("GET_CHECK_VALIDITY")&&t.element.setCustomValidity(t.query("GET_LABEL_INVALID_FIELD"))},DID_SET_DISABLED:toggleDisabled,DID_SET_ALLOW_BROWSE:toggleDisabled,DID_SET_ALLOW_DIRECTORIES_ONLY:toggleDirectoryFilter,DID_SET_ALLOW_MULTIPLE:toggleAllowMultiple,DID_SET_ACCEPTED_FILE_TYPES:setAcceptedFileTypes,DID_SET_CAPTURE_METHOD:setCaptureMethod,DID_SET_REQUIRED:toggleRequired})}),J={ENTER:13,SPACE:32},updateLabelValue=function(e,t){e.innerHTML=t;var r=e.querySelector(".filepond--label-action");return r&&attr(r,"tabindex","0"),t},ee=createView({name:"drop-label",ignoreRect:!0,create:function(e){var t=e.root,r=e.props,n=createElement$1("label");attr(n,"for","filepond--browser-"+r.id),attr(n,"id","filepond--drop-label-"+r.id),attr(n,"aria-hidden","true"),t.ref.handleKeyDown=function(e){(e.keyCode===J.ENTER||e.keyCode===J.SPACE)&&(e.preventDefault(),t.ref.label.click())},t.ref.handleClick=function(e){e.target===n||n.contains(e.target)||t.ref.label.click()},n.addEventListener("keydown",t.ref.handleKeyDown),t.element.addEventListener("click",t.ref.handleClick),updateLabelValue(n,r.caption),t.appendChild(n),t.ref.label=n},destroy:function(e){var t=e.root;t.ref.label.addEventListener("keydown",t.ref.handleKeyDown),t.element.removeEventListener("click",t.ref.handleClick)},write:createRoute({DID_SET_LABEL_IDLE:function(e){var t=e.root,r=e.action;updateLabelValue(t.ref.label,r.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),et=createView({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),addBlob=function(e){var t=e.root,r=.5*t.rect.element.width,n=.5*t.rect.element.height;t.ref.blob=t.appendChildView(t.createChildView(et,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:r,translateY:n}))},er=createRoute({DID_DRAG:function(e){var t=e.root,r=e.action;if(!t.ref.blob){addBlob({root:t});return}t.ref.blob.translateX=r.position.scopeLeft,t.ref.blob.translateY=r.position.scopeTop,t.ref.blob.scaleX=1,t.ref.blob.scaleY=1,t.ref.blob.opacity=1},DID_DROP:function(e){var t=e.root;t.ref.blob&&(t.ref.blob.scaleX=2.5,t.ref.blob.scaleY=2.5,t.ref.blob.opacity=0)},DID_END_DRAG:function(e){var t=e.root;t.ref.blob&&(t.ref.blob.opacity=0)}}),en=createView({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:function(e){var t=e.root,r=e.props,n=e.actions;er({root:t,props:r,actions:n});var i=t.ref.blob;0===n.length&&i&&0===i.opacity&&(t.removeChildView(i),t.ref.blob=null)}}),setInputFiles=function(e,t){try{var r=new DataTransfer;t.forEach(function(e){e instanceof File?r.items.add(e):r.items.add(new File([e],e.name,{type:e.type}))}),e.files=r.files}catch(e){return!1}return!0},getField=function(e,t){return e.ref.fields[t]},syncFieldPositionsWithItems=function(e){e.query("GET_ACTIVE_ITEMS").forEach(function(t){e.ref.fields[t.id]&&e.element.appendChild(e.ref.fields[t.id])})},didReorderItems=function(e){return syncFieldPositionsWithItems(e.root)},ei=createView({tag:"fieldset",name:"data",create:function(e){return e.root.ref.fields={}},write:createRoute({DID_SET_DISABLED:function(e){var t=e.root;t.element.disabled=t.query("GET_DISABLED")},DID_ADD_ITEM:function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id).origin!==m.LOCAL&&t.query("SHOULD_UPDATE_FILE_INPUT"),i=createElement$1("input");i.type=n?"file":"hidden",i.name=t.query("GET_NAME"),i.disabled=t.query("GET_DISABLED"),t.ref.fields[r.id]=i,syncFieldPositionsWithItems(t)},DID_LOAD_ITEM:function(e){var t=e.root,r=e.action,n=getField(t,r.id);n&&(null!==r.serverFileReference&&(n.value=r.serverFileReference),t.query("SHOULD_UPDATE_FILE_INPUT")&&setInputFiles(n,[t.query("GET_ITEM",r.id).file]))},DID_REMOVE_ITEM:function(e){var t=e.root,r=e.action,n=getField(t,r.id);n&&(n.parentNode&&n.parentNode.removeChild(n),delete t.ref.fields[r.id])},DID_DEFINE_VALUE:function(e){var t=e.root,r=e.action,n=getField(t,r.id);n&&(null===r.value?n.removeAttribute("value"):n.value=r.value,syncFieldPositionsWithItems(t))},DID_PREPARE_OUTPUT:function(e){var t=e.root,r=e.action;t.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout(function(){var e=getField(t,r.id);e&&setInputFiles(e,[r.file])},0)},DID_REORDER_ITEMS:didReorderItems,DID_SORT_ITEMS:didReorderItems}),ignoreRect:!0}),eo=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ea=["css","csv","html","txt"],es={zip:"zip|compressed",epub:"application/epub+zip"},guesstimateMimeType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e=e.toLowerCase(),eo.includes(e))?"image/"+("jpg"===e?"jpeg":"svg"===e?"svg+xml":e):ea.includes(e)?"text/"+e:es[e]||""},requestDataTransferItems=function(e){return new Promise(function(t,r){var n=getLinks(e);if(n.length&&!hasFiles(e))return t(n);getFiles(e).then(t)})},hasFiles=function(e){return!!e.files&&e.files.length>0},getFiles=function(e){return new Promise(function(t,r){var n=(e.items?Array.from(e.items):[]).filter(function(e){return isFileSystemItem(e)}).map(function(e){return getFilesFromItem(e)});if(!n.length){t(e.files?Array.from(e.files):[]);return}Promise.all(n).then(function(e){var r=[];e.forEach(function(e){r.push.apply(r,e)}),t(r.filter(function(e){return e}).map(function(e){return e._relativePath||(e._relativePath=e.webkitRelativePath),e}))}).catch(console.error)})},isFileSystemItem=function(e){if(isEntry(e)){var t=getAsEntry(e);if(t)return t.isFile||t.isDirectory}return"file"===e.kind},getFilesFromItem=function(e){return new Promise(function(t,r){if(isDirectoryEntry(e)){getFilesInDirectory(getAsEntry(e)).then(t).catch(r);return}t([e.getAsFile()])})},getFilesInDirectory=function(e){return new Promise(function(t,r){var n=[],i=0,o=0,resolveIfDone=function(){0===o&&0===i&&t(n)};!function readEntries(e){i++;var t=e.createReader();!function readBatch(){t.readEntries(function(e){if(0===e.length){i--,resolveIfDone();return}e.forEach(function(e){e.isDirectory?readEntries(e):(o++,e.file(function(t){var r=correctMissingFileType(t);e.fullPath&&(r._relativePath=e.fullPath),n.push(r),o--,resolveIfDone()}))}),readBatch()},r)}()}(e)})},correctMissingFileType=function(e){if(e.type.length)return e;var t=e.lastModifiedDate,r=e.name,n=guesstimateMimeType(getExtensionFromFilename(e.name));return n.length&&((e=e.slice(0,e.size,n)).name=r,e.lastModifiedDate=t),e},isDirectoryEntry=function(e){return isEntry(e)&&(getAsEntry(e)||{}).isDirectory},isEntry=function(e){return"webkitGetAsEntry"in e},getAsEntry=function(e){return e.webkitGetAsEntry()},getLinks=function(e){var t=[];try{if((t=getLinksFromTransferMetaData(e)).length)return t;t=getLinksFromTransferURLData(e)}catch(e){}return t},getLinksFromTransferURLData=function(e){var t=e.getData("url");return"string"==typeof t&&t.length?[t]:[]},getLinksFromTransferMetaData=function(e){var t=e.getData("text/html");if("string"==typeof t&&t.length){var r=t.match(/src\s*=\s*"(.+?)"/);if(r)return[r[1]]}return[]},el=[],eventPosition=function(e){return{pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}},createDragNDropClient=function(e,t,r){var n=getDragNDropObserver(t),i={element:e,filterElement:r,state:null,ondrop:function(){},onenter:function(){},ondrag:function(){},onexit:function(){},onload:function(){},allowdrop:function(){}};return i.destroy=n.addListener(i),i},getDragNDropObserver=function(e){var t=el.find(function(t){return t.element===e});if(t)return t;var r=createDragNDropObserver(e);return el.push(r),r},createDragNDropObserver=function(e){var t=[],r={dragenter:dragenter,dragover:dragover,dragleave:dragleave,drop:drop},n={};forin(r,function(r,i){n[r]=i(e,t),e.addEventListener(r,n[r],!1)});var i={element:e,addListener:function(o){return t.push(o),function(){t.splice(t.indexOf(o),1),0===t.length&&(el.splice(el.indexOf(i),1),forin(r,function(t){e.removeEventListener(t,n[t],!1)}))}}};return i},isEventTarget=function(e,t){var r,n,i=(r="getRootNode"in t?t.getRootNode():document,n={x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset},"elementFromPoint"in r||(r=document),r.elementFromPoint(n.x,n.y));return i===t||t.contains(i)},eu=null,setDropEffect=function(e,t){try{e.dropEffect=t}catch(e){}},dragenter=function(e,t){return function(e){e.preventDefault(),eu=e.target,t.forEach(function(t){var r=t.element,n=t.onenter;isEventTarget(e,r)&&(t.state="enter",n(eventPosition(e)))})}},dragover=function(e,t){return function(e){e.preventDefault();var r=e.dataTransfer;requestDataTransferItems(r).then(function(n){var i=!1;t.some(function(t){var o=t.filterElement,a=t.element,s=t.onenter,l=t.onexit,u=t.ondrag,c=t.allowdrop;setDropEffect(r,"copy");var f=c(n);if(!f){setDropEffect(r,"none");return}if(isEventTarget(e,a)){if(i=!0,null===t.state){t.state="enter",s(eventPosition(e));return}if(t.state="over",o&&!f){setDropEffect(r,"none");return}u(eventPosition(e))}else o&&!i&&setDropEffect(r,"none"),t.state&&(t.state=null,l(eventPosition(e)))})})}},drop=function(e,t){return function(e){e.preventDefault(),requestDataTransferItems(e.dataTransfer).then(function(r){t.forEach(function(t){var n=t.filterElement,i=t.element,o=t.ondrop,a=t.onexit,s=t.allowdrop;if(t.state=null,!n||isEventTarget(e,i)){if(!s(r))return a(eventPosition(e));o(eventPosition(e),r)}})})}},dragleave=function(e,t){return function(e){eu===e.target&&t.forEach(function(t){var r=t.onexit;t.state=null,r(eventPosition(e))})}},createHopper=function(e,t,r){e.classList.add("filepond--hopper");var n=r.catchesDropsOnPage,i=r.requiresDropOnElement,o=r.filterItems,a=void 0===o?function(e){return e}:o,s=createDragNDropClient(e,n?document.documentElement:e,i),l="",u="";s.allowdrop=function(e){return t(a(e))},s.ondrop=function(e,r){var n=a(r);if(!t(n)){c.ondragend(e);return}u="drag-drop",c.onload(n,e)},s.ondrag=function(e){c.ondrag(e)},s.onenter=function(e){u="drag-over",c.ondragstart(e)},s.onexit=function(e){u="drag-exit",c.ondragend(e)};var c={updateHopperState:function(){l!==u&&(e.dataset.hopperState=u,l=u)},onload:function(){},ondragstart:function(){},ondrag:function(){},ondragend:function(){},destroy:function(){s.destroy()}};return c},ec=!1,ef=[],handlePaste=function(e){var t=document.activeElement;if(t&&/textarea|input/i.test(t.nodeName)){for(var r=!1,n=t;n!==document.body;){if(n.classList.contains("filepond--root")){r=!0;break}n=n.parentNode}if(!r)return}requestDataTransferItems(e.clipboardData).then(function(e){e.length&&ef.forEach(function(t){return t(e)})})},listen=function(e){!ef.includes(e)&&(ef.push(e),ec||(ec=!0,document.addEventListener("paste",handlePaste)))},unlisten=function(e){arrayRemove(ef,ef.indexOf(e)),0===ef.length&&(document.removeEventListener("paste",handlePaste),ec=!1)},createPaster=function(){var cb=function(t){e.onload(t)},e={destroy:function(){unlisten(cb)},onload:function(){}};return listen(cb),e},ed=null,ep=null,eE=[],assist=function(e,t){e.element.textContent=t},clear$1=function(e){e.element.textContent=""},listModified=function(e,t,r){var n=e.query("GET_TOTAL_ITEMS");assist(e,r+" "+t+", "+n+" "+(1===n?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL"))),clearTimeout(ep),ep=setTimeout(function(){clear$1(e)},1500)},isUsingFilePond=function(e){return e.element.parentNode.contains(document.activeElement)},itemProcessedUndo=function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id).filename,i=t.query("GET_LABEL_FILE_PROCESSING_ABORTED");assist(t,n+" "+i)},itemError=function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id).filename;assist(t,r.status.main+" "+n+" "+r.status.sub)},em=createView({create:function(e){var t=e.root,r=e.props;t.element.id="filepond--assistant-"+r.id,attr(t.element,"role","status"),attr(t.element,"aria-live","polite"),attr(t.element,"aria-relevant","additions")},ignoreRect:!0,ignoreRectUpdate:!0,write:createRoute({DID_LOAD_ITEM:function(e){var t=e.root,r=e.action;if(isUsingFilePond(t)){t.element.textContent="";var n=t.query("GET_ITEM",r.id);eE.push(n.filename),clearTimeout(ed),ed=setTimeout(function(){listModified(t,eE.join(", "),t.query("GET_LABEL_FILE_ADDED")),eE.length=0},750)}},DID_REMOVE_ITEM:function(e){var t=e.root,r=e.action;isUsingFilePond(t)&&listModified(t,r.item.filename,t.query("GET_LABEL_FILE_REMOVED"))},DID_COMPLETE_ITEM_PROCESSING:function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id).filename,i=t.query("GET_LABEL_FILE_PROCESSING_COMPLETE");assist(t,n+" "+i)},DID_ABORT_ITEM_PROCESSING:itemProcessedUndo,DID_REVERT_ITEM_PROCESSING:itemProcessedUndo,DID_THROW_ITEM_REMOVE_ERROR:itemError,DID_THROW_ITEM_LOAD_ERROR:itemError,DID_THROW_ITEM_INVALID:itemError,DID_THROW_ITEM_PROCESSING_ERROR:itemError}),tag:"span",name:"assistant"}),toCamels=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.replace(RegExp(t+".","g"),function(e){return e.charAt(1).toUpperCase()})},debounce=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=Date.now(),i=null;return function(){for(var o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];clearTimeout(i);var l=Date.now()-n,fn=function(){n=Date.now(),e.apply(void 0,a)};l<t?r||(i=setTimeout(fn,t-l)):fn()}},prevent=function(e){return e.preventDefault()},calculateListItemMargin=function(e){var t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},calculateListHeight=function(e){var t=0,r=0,n=e.ref.list,i=n.childViews[0],o=i.childViews.filter(function(e){return e.rect.element.height}),a=e.query("GET_ACTIVE_ITEMS").map(function(e){return o.find(function(t){return t.id===e.id})}).filter(function(e){return e});if(0===a.length)return{visual:t,bounds:r};var s=i.rect.element.width,l=getItemIndexByPosition(i,a,n.dragCoordinates),u=a[0].rect.element,c=u.marginTop+u.marginBottom,f=u.marginLeft+u.marginRight,d=u.width+f,p=u.height+c,E=a.find(function(e){return e.markedForRemoval&&e.opacity<.45})?-1:0,m=a.length+(void 0!==l&&l>=0?1:0)+E,I=getItemsPerRow(s,d);return 1===I?a.forEach(function(e){var n=e.rect.element.height+c;r+=n,t+=n*e.opacity}):t=r=Math.ceil(m/I)*p,{visual:t,bounds:r}},calculateRootBoundingBoxHeight=function(e){var t=e.ref.measureHeight||null;return{cappedHeight:parseInt(e.style.maxHeight,10)||null,fixedHeight:0===t?null:t}},exceedsMaxFiles=function(e,t){var r=e.query("GET_ALLOW_REPLACE"),n=e.query("GET_ALLOW_MULTIPLE"),i=e.query("GET_TOTAL_ITEMS"),o=e.query("GET_MAX_FILES"),a=t.length;return!n&&a>1?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:createResponse("warning",0,"Max files")}),!0):(o=n?o:1,(!!n||!r)&&!!isInt(o)&&i+a>o&&(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:createResponse("warning",0,"Max files")}),!0))},getDragIndex=function(e,t,r){var n=e.childViews[0];return getItemIndexByPosition(n,t,{left:r.scopeLeft-n.rect.element.left,top:r.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},toggleDrop=function(e){var t=e.query("GET_ALLOW_DROP"),r=e.query("GET_DISABLED"),n=t&&!r;if(n&&!e.ref.hopper){var i=createHopper(e.element,function(t){var r=e.query("GET_BEFORE_DROP_FILE")||function(){return!0};return!e.query("GET_DROP_VALIDATION")||t.every(function(t){return applyFilters("ALLOW_HOPPER_ITEM",t,{query:e.query}).every(function(e){return!0===e})&&r(t)})},{filterItems:function(t){var r=e.query("GET_IGNORED_FILES");return t.filter(function(e){return!isFile(e)||!r.includes(e.name.toLowerCase())})},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});i.onload=function(t,r){var n=e.ref.list.childViews[0].childViews.filter(function(e){return e.rect.element.height}),i=e.query("GET_ACTIVE_ITEMS").map(function(e){return n.find(function(t){return t.id===e.id})}).filter(function(e){return e});applyFilterChain("ADD_ITEMS",t,{dispatch:e.dispatch}).then(function(t){if(exceedsMaxFiles(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:getDragIndex(e.ref.list,i,r),interactionMethod:d.DROP})}),e.dispatch("DID_DROP",{position:r}),e.dispatch("DID_END_DRAG",{position:r})},i.ondragstart=function(t){e.dispatch("DID_START_DRAG",{position:t})},i.ondrag=debounce(function(t){e.dispatch("DID_DRAG",{position:t})}),i.ondragend=function(t){e.dispatch("DID_END_DRAG",{position:t})},e.ref.hopper=i,e.ref.drip=e.appendChildView(e.createChildView(en))}else!n&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},toggleBrowse=function(e,t){var r=e.query("GET_ALLOW_BROWSE"),n=e.query("GET_DISABLED"),i=r&&!n;i&&!e.ref.browser?e.ref.browser=e.appendChildView(e.createChildView(K,Object.assign({},t,{onload:function(t){applyFilterChain("ADD_ITEMS",t,{dispatch:e.dispatch}).then(function(t){if(exceedsMaxFiles(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:-1,interactionMethod:d.BROWSE})})}})),0):!i&&e.ref.browser&&(e.removeChildView(e.ref.browser),e.ref.browser=null)},togglePaste=function(e){var t=e.query("GET_ALLOW_PASTE"),r=e.query("GET_DISABLED"),n=t&&!r;n&&!e.ref.paster?(e.ref.paster=createPaster(),e.ref.paster.onload=function(t){applyFilterChain("ADD_ITEMS",t,{dispatch:e.dispatch}).then(function(t){if(exceedsMaxFiles(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:-1,interactionMethod:d.PASTE})})}):!n&&e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},eI=createRoute({DID_SET_ALLOW_BROWSE:function(e){toggleBrowse(e.root,e.props)},DID_SET_ALLOW_DROP:function(e){toggleDrop(e.root)},DID_SET_ALLOW_PASTE:function(e){togglePaste(e.root)},DID_SET_DISABLED:function(e){var t=e.root,r=e.props;toggleDrop(t),togglePaste(t),toggleBrowse(t,r),t.query("GET_DISABLED")?t.element.dataset.disabled="disabled":t.element.removeAttribute("data-disabled")}}),eg=createView({name:"root",read:function(e){var t=e.root;t.ref.measure&&(t.ref.measureHeight=t.ref.measure.offsetHeight)},create:function(e){var t=e.root,r=e.props,n=t.query("GET_ID");n&&(t.element.id=n);var i=t.query("GET_CLASS_NAME");i&&i.split(" ").filter(function(e){return e.length}).forEach(function(e){t.element.classList.add(e)}),t.ref.label=t.appendChildView(t.createChildView(ee,Object.assign({},r,{translateY:null,caption:t.query("GET_LABEL_IDLE")}))),t.ref.list=t.appendChildView(t.createChildView(Z,{translateY:null})),t.ref.panel=t.appendChildView(t.createChildView(q,{name:"panel-root"})),t.ref.assistant=t.appendChildView(t.createChildView(em,Object.assign({},r))),t.ref.data=t.appendChildView(t.createChildView(ei,Object.assign({},r))),t.ref.measure=createElement$1("div"),t.ref.measure.style.height="100%",t.element.appendChild(t.ref.measure),t.ref.bounds=null,t.query("GET_STYLES").filter(function(e){return!isEmpty(e.value)}).map(function(e){var r=e.name,n=e.value;t.element.dataset[r]=n}),t.ref.widthPrevious=null,t.ref.widthUpdated=debounce(function(){t.ref.updateHistory=[],t.dispatch("DID_RESIZE_ROOT")},250),t.ref.previousAspectRatio=null,t.ref.updateHistory=[];var o=window.matchMedia("(pointer: fine) and (hover: hover)").matches,a="PointerEvent"in window;t.query("GET_ALLOW_REORDER")&&a&&!o&&(t.element.addEventListener("touchmove",prevent,{passive:!1}),t.element.addEventListener("gesturestart",prevent));var s=t.query("GET_CREDITS");if(2===s.length){var l=document.createElement("a");l.className="filepond--credits",l.setAttribute("aria-hidden","true"),l.href=s[0],l.tabindex=-1,l.target="_blank",l.rel="noopener noreferrer",l.textContent=s[1],t.element.appendChild(l),t.ref.credits=l}},write:function(e){var t=e.root,r=e.props,n=e.actions;if(eI({root:t,props:r,actions:n}),n.filter(function(e){return/^DID_SET_STYLE_/.test(e.type)}).filter(function(e){return!isEmpty(e.data.value)}).map(function(e){var r=e.type,n=e.data,i=toCamels(r.substring(8).toLowerCase(),"_");t.element.dataset[i]=n.value,t.invalidateLayout()}),!t.rect.element.hidden){t.rect.element.width!==t.ref.widthPrevious&&(t.ref.widthPrevious=t.rect.element.width,t.ref.widthUpdated());var i=t.ref.bounds;i||(i=t.ref.bounds=calculateRootBoundingBoxHeight(t),t.element.removeChild(t.ref.measure),t.ref.measure=null);var o=t.ref,a=o.hopper,s=o.label,l=o.list,u=o.panel;a&&a.updateHopperState();var c=t.query("GET_PANEL_ASPECT_RATIO"),f=t.query("GET_ALLOW_MULTIPLE"),p=t.query("GET_TOTAL_ITEMS"),E=p===(f?t.query("GET_MAX_FILES")||1e6:1),m=n.find(function(e){return"DID_ADD_ITEM"===e.type});if(E&&m){var I=m.data.interactionMethod;s.opacity=0,f?s.translateY=-40:I===d.API?s.translateX=40:I===d.BROWSE?s.translateY=40:s.translateY=30}else E||(s.opacity=1,s.translateX=0,s.translateY=0);var g=calculateListItemMargin(t),_=calculateListHeight(t),T=s.rect.element.height,v=!f||E?0:T,h=E?l.rect.element.marginTop:0,R=0===p?0:l.rect.element.marginBottom,O=v+h+_.visual+R,y=v+h+_.bounds+R;if(l.translateY=Math.max(0,v-l.rect.element.marginTop)-g.top,c){var D=t.rect.element.width,S=D*c;c!==t.ref.previousAspectRatio&&(t.ref.previousAspectRatio=c,t.ref.updateHistory=[]);var A=t.ref.updateHistory;if(A.push(D),A.length>4){for(var b=A.length,P=b-10,L=0,C=b;C>=P;C--)if(A[C]===A[C-2]&&L++,L>=2)return}u.scalable=!1,u.height=S;var M=S-v-(R-g.bottom)-(E?h:0);_.visual>M?l.overflow=M:l.overflow=null,t.height=S}else if(i.fixedHeight){u.scalable=!1;var N=i.fixedHeight-v-(R-g.bottom)-(E?h:0);_.visual>N?l.overflow=N:l.overflow=null}else if(i.cappedHeight){var w=O>=i.cappedHeight,F=Math.min(i.cappedHeight,O);u.scalable=!0,u.height=w?F:F-g.top-g.bottom;var G=F-v-(R-g.bottom)-(E?h:0);O>i.cappedHeight&&_.visual>G?l.overflow=G:l.overflow=null,t.height=Math.min(i.cappedHeight,y-g.top-g.bottom)}else{var B=p>0?g.top+g.bottom:0;u.scalable=!0,u.height=Math.max(T,O-B),t.height=Math.max(T,y-B)}t.ref.credits&&u.heightCurrent&&(t.ref.credits.style.transform="translateY("+u.heightCurrent+"px)")}},destroy:function(e){var t=e.root;t.ref.paster&&t.ref.paster.destroy(),t.ref.hopper&&t.ref.hopper.destroy(),t.element.removeEventListener("touchmove",prevent),t.element.removeEventListener("gesturestart",prevent)},mixins:{styles:["height"]}}),createApp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null,r=getOptions(),n=createStore({items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:createOptions(r)},[queries,function(e){var t={};return forin(r,function(r){t["GET_"+fromCamels(r,"_").toUpperCase()]=function(t){return e.options[r]}}),t}],[actions,function(e,t,n){var i={};return forin(r,function(t){var r=fromCamels(t,"_").toUpperCase();i["SET_"+r]=function(i){try{n.options[t]=i.value}catch(e){}e("DID_SET_"+r,{value:n.options[t]})}}),i}]);n.dispatch("SET_OPTIONS",{options:e});var visibilityHandler=function(){document.hidden||n.dispatch("KICK")};document.addEventListener("visibilitychange",visibilityHandler);var i=null,o=!1,a=!1,s=null,l=null,resizeHandler=function(){o||(o=!0),clearTimeout(i),i=setTimeout(function(){o=!1,s=null,l=null,a&&(a=!1,n.dispatch("DID_STOP_RESIZE"))},500)};window.addEventListener("resize",resizeHandler);var u=eg(n,{id:getUniqueId()}),c=!1,f=!1,createEvent=function(e){return function(t){var r={type:e};if(!t)return r;if(t.hasOwnProperty("error")&&(r.error=t.error?Object.assign({},t.error):null),t.status&&(r.status=Object.assign({},t.status)),t.file&&(r.output=t.file),t.source)r.file=t.source;else if(t.item||t.id){var i=t.item?t.item:n.query("GET_ITEM",t.id);r.file=i?createItemAPI(i):null}return t.items&&(r.items=t.items.map(createItemAPI)),/progress/.test(e)&&(r.progress=t.progress),t.hasOwnProperty("origin")&&t.hasOwnProperty("target")&&(r.origin=t.origin,r.target=t.target),r}},p={DID_DESTROY:createEvent("destroy"),DID_INIT:createEvent("init"),DID_THROW_MAX_FILES:createEvent("warning"),DID_INIT_ITEM:createEvent("initfile"),DID_START_ITEM_LOAD:createEvent("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:createEvent("addfileprogress"),DID_LOAD_ITEM:createEvent("addfile"),DID_THROW_ITEM_INVALID:[createEvent("error"),createEvent("addfile")],DID_THROW_ITEM_LOAD_ERROR:[createEvent("error"),createEvent("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[createEvent("error"),createEvent("removefile")],DID_PREPARE_OUTPUT:createEvent("preparefile"),DID_START_ITEM_PROCESSING:createEvent("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:createEvent("processfileprogress"),DID_ABORT_ITEM_PROCESSING:createEvent("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:createEvent("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:createEvent("processfiles"),DID_REVERT_ITEM_PROCESSING:createEvent("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[createEvent("error"),createEvent("processfile")],DID_REMOVE_ITEM:createEvent("removefile"),DID_UPDATE_ITEMS:createEvent("updatefiles"),DID_ACTIVATE_ITEM:createEvent("activatefile"),DID_REORDER_ITEMS:createEvent("reorderfiles")},exposeEvent=function(e){var t=Object.assign({pond:I},e);delete t.type,u.element.dispatchEvent(new CustomEvent("FilePond:"+e.type,{detail:t,bubbles:!0,cancelable:!0,composed:!0}));var r=[];e.hasOwnProperty("error")&&r.push(e.error),e.hasOwnProperty("file")&&r.push(e.file);var i=["type","error","file"];Object.keys(e).filter(function(e){return!i.includes(e)}).forEach(function(t){return r.push(e[t])}),I.fire.apply(I,[e.type].concat(r));var o=n.query("GET_ON"+e.type.toUpperCase());o&&o.apply(void 0,r)},routeActionsToEvents=function(e){e.length&&e.filter(function(e){return p[e.type]}).forEach(function(e){var t=p[e.type];(Array.isArray(t)?t:[t]).forEach(function(t){"DID_INIT_ITEM"===e.type?exposeEvent(t(e.data)):setTimeout(function(){exposeEvent(t(e.data))},0)})})},prepareFile=function(e){return new Promise(function(t,r){n.dispatch("REQUEST_ITEM_PREPARE",{query:e,success:function(e){t(e)},failure:function(e){r(e)}})})},removeFile=function(e,t){var r;return"object"!=typeof e||(r=e).file&&r.id||t||(t=e,e=void 0),n.dispatch("REMOVE_ITEM",Object.assign({},t,{query:e})),null===n.query("GET_ACTIVE_ITEM",e)},addFiles=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Promise(function(e,r){var i=[],o={};if(isArray(t[0]))i.push.apply(i,t[0]),Object.assign(o,t[1]||{});else{var a=t[t.length-1];"object"!=typeof a||a instanceof Blob||Object.assign(o,t.pop()),i.push.apply(i,t)}n.dispatch("ADD_ITEMS",{items:i,index:o.index,interactionMethod:d.API,success:e,failure:r})})},getFiles=function(){return n.query("GET_ACTIVE_ITEMS")},processFile=function(e){return new Promise(function(t,r){n.dispatch("REQUEST_ITEM_PROCESSING",{query:e,success:function(e){t(e)},failure:function(e){r(e)}})})},I=Object.assign({},on(),{},{_read:function(){o&&(l=window.innerWidth,s||(s=l),a||l===s||(n.dispatch("DID_START_RESIZE"),a=!0)),f&&c&&(c=null===u.element.offsetParent),c||(u._read(),f=u.rect.element.hidden)},_write:function(e){var t=n.processActionQueue().filter(function(e){return!/^SET_/.test(e.type)});(!c||t.length)&&(routeActionsToEvents(t),c=u._write(e,t,a),removeReleasedItems(n.query("GET_ITEMS")),c&&n.processDispatchQueue())}},{},createOptionAPI(n,r),{setOptions:function(e){return n.dispatch("SET_OPTIONS",{options:e})},addFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(r,n){addFiles([{source:e,options:t}],{index:t.index}).then(function(e){return r(e&&e[0])}).catch(n)})},addFiles:addFiles,getFile:function(e){return n.query("GET_ACTIVE_ITEM",e)},processFile:processFile,prepareFile:prepareFile,removeFile:removeFile,moveFile:function(e,t){return n.dispatch("MOVE_ITEM",{query:e,index:t})},getFiles:getFiles,processFiles:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Array.isArray(t[0])?t[0]:t;return n.length?Promise.all(n.map(processFile)):Promise.all(getFiles().filter(function(e){return!(e.status===E.IDLE&&e.origin===m.LOCAL)&&e.status!==E.PROCESSING&&e.status!==E.PROCESSING_COMPLETE&&e.status!==E.PROCESSING_REVERT_ERROR}).map(processFile))},removeFiles:function(){for(var e,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=Array.isArray(r[0])?r[0]:r;"object"==typeof i[i.length-1]?e=i.pop():Array.isArray(r[0])&&(e=r[1]);var o=getFiles();return i.length?i.map(function(e){return isNumber(e)?o[e]?o[e].id:null:e}).filter(function(e){return e}).map(function(t){return removeFile(t,e)}):Promise.all(o.map(function(t){return removeFile(t,e)}))},prepareFiles:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Array.isArray(t[0])?t[0]:t;return Promise.all((n.length?n:getFiles()).map(prepareFile))},sort:function(e){return n.dispatch("SORT",{compare:e})},browse:function(){var e=u.element.querySelector("input[type=file]");e&&e.click()},destroy:function(){I.fire("destroy",u.element),n.dispatch("ABORT_ALL"),u._destroy(),window.removeEventListener("resize",resizeHandler),document.removeEventListener("visibilitychange",visibilityHandler),n.dispatch("DID_DESTROY")},insertBefore:function(e){return insertBefore(u.element,e)},insertAfter:function(e){return insertAfter(u.element,e)},appendTo:function(e){return e.appendChild(u.element)},replaceElement:function(e){insertBefore(u.element,e),e.parentNode.removeChild(e),t=e},restoreElement:function(){t&&(insertAfter(t,u.element),u.element.parentNode.removeChild(u.element),t=null)},isAttachedTo:function(e){return u.element===e||t===e},element:{get:function(){return u.element}},status:{get:function(){return n.query("GET_STATUS")}}});return n.dispatch("DID_INIT"),createObject(I)},createAppObject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return forin(getOptions(),function(e,r){t[e]=r[0]}),createApp(Object.assign({},t,{},e))},mapObject=function mapObject(e,t){forin(t,function(t,r){forin(e,function(n,i){var o,a=new RegExp(t);if(a.test(n)&&(delete e[n],!1!==r)){if(isString(r)){e[r]=i;return}var s=r.group;isObject(r)&&!e[s]&&(e[s]={}),e[s][(o=n.replace(a,"")).charAt(0).toLowerCase()+o.slice(1)]=i}}),r.mapping&&mapObject(e[r.group],r.mapping)})},getAttributesAsObject=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];forin(e.attributes,function(t){r.push(e.attributes[t])});var n=r.filter(function(e){return e.name}).reduce(function(t,r){var n=attr(e,r.name);return t[toCamels(r.name.replace(/^data-/,""))]=n===r.name||n,t},{});return mapObject(n,t),n},createAppAtElement=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};applyFilters("SET_ATTRIBUTE_TO_OPTION_MAP",r);var n=Object.assign({},t),i=getAttributesAsObject("FIELDSET"===e.nodeName?e.querySelector("input[type=file]"):e,r);Object.keys(i).forEach(function(e){isObject(i[e])?(isObject(n[e])||(n[e]={}),Object.assign(n[e],i[e])):n[e]=i[e]}),n.files=(t.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map(function(e){return{source:e.value,options:{type:e.dataset.type}}}));var o=createAppObject(n);return e.files&&Array.from(e.files).forEach(function(e){o.addFile(e)}),o.replaceElement(e),o},createApp$1=function(){var e;return(e=arguments.length<=0?void 0:arguments[0],e instanceof HTMLElement)?createAppAtElement.apply(void 0,arguments):createAppObject.apply(void 0,arguments)},e_=["fire","_read","_write"],createAppAPI=function(e){var t={};return copyObjectPropertiesToObject(e,t,e_),t},replaceInString=function(e,t){return e.replace(/(?:{([a-zA-Z]+)})/g,function(e,r){return t[r]})},createWorker=function(e){var t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),r=URL.createObjectURL(t),n=new Worker(r);return{transfer:function(e,t){},post:function(e,t,r){var i=getUniqueId();n.onmessage=function(e){e.data.id===i&&t(e.data.message)},n.postMessage({id:i,message:e},r)},terminate:function(){n.terminate(),URL.revokeObjectURL(r)}}},loadImage=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=function(e){r(e)},n.src=e})},renameFile=function(e,t){var r=e.slice(0,e.size,e.type);return r.lastModifiedDate=e.lastModifiedDate,r.name=t,r},copyFile=function(e){return renameFile(e,e.name)},eT=[],createAppPlugin=function(e){eT.includes(e)||(eT.push(e),Object.assign(_,e({addFilter:addFilter,utils:{Type:I,forin:forin,isString:isString,isFile:isFile,toNaturalFileSize:toNaturalFileSize,replaceInString:replaceInString,getExtensionFromFilename:getExtensionFromFilename,getFilenameWithoutExtension:getFilenameWithoutExtension,guesstimateMimeType:guesstimateMimeType,getFileFromBlob:getFileFromBlob,getFilenameFromURL:getFilenameFromURL,createRoute:createRoute,createWorker:createWorker,createView:createView,createItemAPI:createItemAPI,loadImage:loadImage,copyFile:copyFile,renameFile:renameFile,createBlob:createBlob,applyFilterChain:applyFilterChain,text:text,getNumericAspectRatioFromString:getNumericAspectRatioFromString},views:{fileActionButton:A}}).options))},ev=(n=isBrowser()&&"[object OperaMini]"!==Object.prototype.toString.call(window.operamini)&&"visibilityState"in document&&"Promise"in window&&"slice"in Blob.prototype&&"URL"in window&&"createObjectURL"in window.URL&&"performance"in window&&("supports"in(window.CSS||{})||/MSIE|Trident/.test(window.navigator.userAgent)),function(){return n}),eh={apps:[]},fn=function(){};if(e.Status={},e.FileStatus={},e.FileOrigin={},e.OptionTypes={},e.create=fn,e.destroy=fn,e.parse=fn,e.find=fn,e.registerPlugin=fn,e.getOptions=fn,e.setOptions=fn,ev()){!function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,n="__framePainter";if(window[n]){window[n].readers.push(e),window[n].writers.push(t);return}window[n]={readers:[e],writers:[t]};var i=window[n],o=1e3/r,a=null,s=null,l=null,u=null,setTimerType=function(){document.hidden?(l=function(){return window.setTimeout(function(){return tick(performance.now())},o)},u=function(){return window.clearTimeout(s)}):(l=function(){return window.requestAnimationFrame(tick)},u=function(){return window.cancelAnimationFrame(s)})};document.addEventListener("visibilitychange",function(){u&&u(),setTimerType(),tick(performance.now())});var tick=function tick(e){s=l(tick),a||(a=e);var t=e-a;t<=o||(a=e-t%o,i.readers.forEach(function(e){return e()}),i.writers.forEach(function(t){return t(e)}))};setTimerType(),tick(performance.now())}(function(){eh.apps.forEach(function(e){return e._read()})},function(e){eh.apps.forEach(function(t){return t._write(e)})});var dispatch=function dispatch(){document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:ev,create:e.create,destroy:e.destroy,parse:e.parse,find:e.find,registerPlugin:e.registerPlugin,setOptions:e.setOptions}})),document.removeEventListener("DOMContentLoaded",dispatch)};"loading"!==document.readyState?setTimeout(function(){return dispatch()},0):document.addEventListener("DOMContentLoaded",dispatch);var updateOptionTypes=function(){return forin(getOptions(),function(t,r){e.OptionTypes[t]=r[1]})};e.Status=Object.assign({},T),e.FileOrigin=Object.assign({},m),e.FileStatus=Object.assign({},E),e.OptionTypes={},updateOptionTypes(),e.create=function(){var t=createApp$1.apply(void 0,arguments);return t.on("destroy",e.destroy),eh.apps.push(t),createAppAPI(t)},e.destroy=function(e){var t=eh.apps.findIndex(function(t){return t.isAttachedTo(e)});return t>=0&&(eh.apps.splice(t,1)[0].restoreElement(),!0)},e.parse=function(t){return Array.from(t.querySelectorAll(".filepond")).filter(function(e){return!eh.apps.find(function(t){return t.isAttachedTo(e)})}).map(function(t){return e.create(t)})},e.find=function(e){var t=eh.apps.find(function(t){return t.isAttachedTo(e)});return t?createAppAPI(t):null},e.registerPlugin=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(createAppPlugin),updateOptionTypes()},e.getOptions=function(){var e={};return forin(getOptions(),function(t,r){e[t]=r[0]}),e},e.setOptions=function(t){return isObject(t)&&(eh.apps.forEach(function(e){e.setOptions(t)}),setOptions(t)),e.getOptions()}}e.supported=ev,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);